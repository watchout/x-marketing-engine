<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>X Marketing Engine Dashboard</title>
  <style>
    :root {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-card: #21262d;
      --bg-hover: #30363d;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --accent-blue: #58a6ff;
      --accent-green: #3fb950;
      --accent-orange: #d29922;
      --accent-red: #f85149;
      --accent-purple: #a371f7;
      --accent-cyan: #79c0ff;
      --border: #30363d;
      --success: #238636;
      --warning: #9e6a03;
      --danger: #da3633;
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.5;
    }
    
    /* Auth Screen */
    .auth-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--bg-primary) 0%, #1a1f2e 100%);
    }
    
    .auth-box {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 40px;
      width: 100%;
      max-width: 400px;
      text-align: center;
    }
    
    .auth-box h1 {
      font-size: 24px;
      margin-bottom: 8px;
    }
    
    .auth-box p {
      color: var(--text-secondary);
      margin-bottom: 24px;
      font-size: 14px;
    }
    
    .auth-input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 16px;
      margin-bottom: 16px;
      outline: none;
      transition: border-color 0.2s;
    }
    
    .auth-input:focus {
      border-color: var(--accent-blue);
    }
    
    .auth-input::placeholder {
      color: var(--text-muted);
    }
    
    .auth-btn {
      width: 100%;
      padding: 12px 24px;
      background: var(--accent-blue);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: opacity 0.2s;
    }
    
    .auth-btn:hover {
      opacity: 0.9;
    }
    
    .auth-error {
      color: var(--accent-red);
      font-size: 14px;
      margin-top: 12px;
      display: none;
    }
    
    .auth-error.show {
      display: block;
    }
    
    .container { max-width: 1400px; margin: 0 auto; padding: 24px; }
    
    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }
    
    .header h1 {
      font-size: 24px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .status-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
    }
    
    .status-active { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
    .status-warning { background: rgba(210, 153, 34, 0.15); color: var(--accent-orange); }
    .status-error { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
    
    .status-badge::before {
      content: '';
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: currentColor;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }
    
    .last-updated { color: var(--text-muted); font-size: 12px; }
    
    /* Navigation Tabs */
    .tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 24px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 0;
    }
    
    .tab {
      padding: 12px 20px;
      cursor: pointer;
      color: var(--text-secondary);
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      font-size: 14px;
    }
    
    .tab:hover { color: var(--text-primary); }
    .tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); }
    
    /* Tab Content */
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    
    /* Grid Layouts */
    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
    .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px; }
    
    @media (max-width: 1200px) { .grid-4 { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 768px) { 
      .grid-4, .grid-3, .grid-2 { grid-template-columns: 1fr; }
    }
    
    /* Cards */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px;
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .card-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .card-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 12px;
      font-weight: 500;
    }
    
    /* Stats Cards */
    .stat-card .value {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    
    .stat-card .label {
      color: var(--text-secondary);
      font-size: 13px;
    }
    
    .stat-card .change {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 4px;
      margin-top: 8px;
    }
    
    .change.up { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
    .change.down { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
    .change.neutral { background: rgba(139, 148, 158, 0.15); color: var(--text-secondary); }
    
    /* KPI Progress */
    .kpi-progress {
      margin-top: 12px;
    }
    
    .kpi-bar {
      height: 6px;
      background: var(--bg-hover);
      border-radius: 3px;
      overflow: hidden;
    }
    
    .kpi-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s ease;
    }
    
    .kpi-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 6px;
      font-size: 11px;
      color: var(--text-muted);
    }
    
    /* Section Headers */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 32px 0 16px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border);
    }
    
    .section-title {
      font-size: 18px;
      font-weight: 600;
    }
    
    /* Tables */
    .table-container {
      overflow-x: auto;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    
    th {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
    }
    
    tr:hover { background: var(--bg-hover); }
    
    /* Post Cards */
    .post-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 12px;
    }
    
    .post-meta {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 12px;
      color: var(--text-muted);
    }
    
    .post-content {
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 12px;
      white-space: pre-wrap;
    }
    
    .post-metrics {
      display: flex;
      gap: 20px;
      font-size: 13px;
      color: var(--text-secondary);
    }
    
    .post-metrics span {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .post-type-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .type-tips { background: rgba(88, 166, 255, 0.15); color: var(--accent-blue); }
    .type-problem { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
    .type-story { background: rgba(163, 113, 247, 0.15); color: var(--accent-purple); }
    .type-discovery { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
    .type-thread { background: rgba(210, 153, 34, 0.15); color: var(--accent-orange); }
    
    /* Influencer Cards */
    .influencer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 16px;
    }
    
    .influencer-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      transition: transform 0.2s, border-color 0.2s;
    }
    
    .influencer-card:hover {
      transform: translateY(-2px);
      border-color: var(--accent-blue);
    }
    
    .influencer-card.priority { border-color: var(--accent-orange); }
    
    .influencer-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }
    
    .influencer-handle {
      font-weight: 600;
      color: var(--accent-blue);
    }
    
    .tier-badge {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 600;
    }
    
    .tier-1 { background: linear-gradient(135deg, #ffd700, #ffb347); color: #000; }
    .tier-2 { background: linear-gradient(135deg, #c0c0c0, #a8a8a8); color: #000; }
    .tier-3 { background: linear-gradient(135deg, #cd7f32, #a0522d); color: #fff; }
    
    .influencer-name {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }
    
    .influencer-stats {
      display: flex;
      gap: 16px;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }
    
    .learn-points {
      padding-top: 12px;
      border-top: 1px solid var(--border);
    }
    
    .learn-points h4 {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 8px;
      text-transform: uppercase;
    }
    
    .tag {
      display: inline-block;
      font-size: 11px;
      padding: 3px 8px;
      background: var(--bg-card);
      border-radius: 4px;
      margin: 2px;
    }
    
    /* Schedule */
    .schedule-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
    
    .schedule-slot {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }
    
    .schedule-slot.next { border-color: var(--accent-green); }
    .schedule-slot.completed { opacity: 0.6; }
    
    .schedule-time {
      font-size: 28px;
      font-weight: 700;
      color: var(--accent-blue);
    }
    
    .schedule-type {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
    
    .schedule-status {
      font-size: 11px;
      margin-top: 8px;
      padding: 4px 12px;
      border-radius: 12px;
      display: inline-block;
    }
    
    /* Analysis Charts */
    .chart-placeholder {
      height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-secondary);
      border-radius: 8px;
      color: var(--text-muted);
    }
    
    .bar-chart {
      display: flex;
      align-items: flex-end;
      gap: 8px;
      height: 150px;
      padding: 16px 0;
    }
    
    .bar-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .bar {
      width: 100%;
      max-width: 40px;
      background: var(--accent-blue);
      border-radius: 4px 4px 0 0;
      min-height: 4px;
      transition: height 0.5s ease;
    }
    
    .bar-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 8px;
      text-align: center;
    }
    
    .bar-value {
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    /* Activity Log */
    .activity-log {
      max-height: 400px;
      overflow-y: auto;
    }
    
    .log-entry {
      display: flex;
      gap: 12px;
      padding: 12px;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
    }
    
    .log-time {
      color: var(--text-muted);
      min-width: 140px;
    }
    
    .log-icon {
      width: 20px;
      text-align: center;
    }
    
    .log-message { flex: 1; }
    
    /* Alerts */
    .alert {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    
    .alert-warning { background: rgba(210, 153, 34, 0.1); border: 1px solid var(--accent-orange); }
    .alert-error { background: rgba(248, 81, 73, 0.1); border: 1px solid var(--accent-red); }
    .alert-success { background: rgba(63, 185, 80, 0.1); border: 1px solid var(--accent-green); }
    
    .alert-icon { font-size: 18px; }
    .alert-content h4 { font-size: 14px; margin-bottom: 4px; }
    .alert-content p { font-size: 13px; color: var(--text-secondary); }
    
    /* Action Items */
    .action-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      margin-bottom: 8px;
    }
    
    .action-priority {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }
    
    .priority-high { background: var(--accent-red); }
    .priority-medium { background: var(--accent-orange); }
    .priority-low { background: var(--accent-blue); }
    
    .action-content { flex: 1; }
    .action-title { font-size: 14px; font-weight: 500; }
    .action-desc { font-size: 12px; color: var(--text-secondary); }

    /* Quick Stats Row */
    .quick-stats {
      display: flex;
      gap: 24px;
      padding: 16px 20px;
      background: var(--bg-secondary);
      border-radius: 8px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    
    .quick-stat {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .quick-stat-value { font-weight: 600; }
    .quick-stat-label { color: var(--text-muted); font-size: 13px; }

    /* Loading */
    #loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 50vh;
      gap: 16px;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--border);
      border-top-color: var(--accent-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Auth Screen -->
  <div id="auth-screen" class="auth-screen">
    <div class="auth-box">
      <h1>ğŸ” X Marketing Dashboard</h1>
      <p>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
      <form id="auth-form">
        <input type="password" id="auth-password" class="auth-input" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" autocomplete="current-password">
        <button type="submit" class="auth-btn">ãƒ­ã‚°ã‚¤ãƒ³</button>
        <p id="auth-error" class="auth-error">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“</p>
      </form>
    </div>
  </div>

  <!-- Main Dashboard -->
  <div id="dashboard-wrapper" style="display: none;">
  <div class="container">
    <header class="header">
      <h1>
        <span style="font-size: 28px;">ğŸ“Š</span>
        X Marketing Engine
      </h1>
      <div class="header-right">
        <a href="settings.html" style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; background: var(--bg-card); border-radius: 20px; font-size: 14px; color: var(--text-primary); text-decoration: none; border: 1px solid var(--border); transition: border-color 0.2s;" onmouseover="this.style.borderColor='var(--accent-blue)'" onmouseout="this.style.borderColor='var(--border)'">
          <span>âš™ï¸</span>
          <span>è¨­å®š</span>
        </a>
        <div id="follower-count" style="display: flex; align-items: center; gap: 8px; padding: 6px 12px; background: var(--bg-card); border-radius: 20px; font-size: 14px;">
          <span style="color: var(--accent-blue);">ğŸ‘¥</span>
          <span id="follower-number" style="font-weight: 600;">-</span>
          <span style="color: var(--text-secondary);">ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
        </div>
        <div class="status-badge status-warning" id="system-status">
          ç¢ºèªä¸­...
        </div>
        <div class="last-updated" id="last-updated">-</div>
      </div>
    </header>

    <div class="tabs">
      <div class="tab active" data-tab="overview">æ¦‚è¦</div>
      <div class="tab" data-tab="posts">æŠ•ç¨¿ä¸€è¦§</div>
      <div class="tab" data-tab="analysis">åˆ†æ</div>
      <div class="tab" data-tab="benchmark">ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</div>
      <div class="tab" data-tab="schedule">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</div>
      <div class="tab" data-tab="logs">ãƒ­ã‚°</div>
    </div>

    <div id="loading">
      <div class="spinner"></div>
      <div style="color: var(--text-muted);">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>

    <div id="main-content" style="display: none;">
      
      <!-- ===== æ¦‚è¦ã‚¿ãƒ– ===== -->
      <div class="tab-content active" id="tab-overview">
        <div id="alerts-container"></div>
        
        <div class="grid-4" id="main-stats"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“ˆ KPIé”æˆçŠ¶æ³</h2>
        </div>
        <div class="grid-3" id="kpi-cards"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ† ãƒˆãƒƒãƒ—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŠ•ç¨¿</h2>
        </div>
        <div id="top-posts"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“‹ æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h2>
        </div>
        <div id="action-items"></div>
      </div>

      <!-- ===== æŠ•ç¨¿ä¸€è¦§ã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-posts">
        <div class="quick-stats" id="posts-quick-stats"></div>
        
        <div class="section-header">
          <h2 class="section-title">æŠ•ç¨¿å±¥æ­´</h2>
          <select id="posts-filter" style="background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); padding: 8px 12px; border-radius: 6px;">
            <option value="all">ã™ã¹ã¦</option>
            <option value="tips">Tipså‹</option>
            <option value="problem_statement">å•é¡Œæèµ·å‹</option>
            <option value="story">ç‰©èªå‹</option>
            <option value="discovery">ç™ºè¦‹å‹</option>
            <option value="thread">ã‚¹ãƒ¬ãƒƒãƒ‰</option>
          </select>
        </div>
        <div id="posts-list"></div>
      </div>

      <!-- ===== åˆ†æã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-analysis">
        <div class="grid-2">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">æŠ•ç¨¿ã‚¿ã‚¤ãƒ—åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h3>
            </div>
            <div id="type-performance"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">æ™‚é–“å¸¯åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h3>
            </div>
            <div id="time-performance"></div>
          </div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“Š é€±æ¬¡ãƒˆãƒ¬ãƒ³ãƒ‰</h2>
        </div>
        <div class="card">
          <div id="weekly-trend"></div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ” ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ†æ</h2>
        </div>
        <div class="grid-2">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ç´ </h3>
            </div>
            <div id="winning-elements"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">æ”¹å–„ãƒã‚¤ãƒ³ãƒˆ</h3>
            </div>
            <div id="improvement-points"></div>
          </div>
        </div>
      </div>

      <!-- ===== ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-benchmark">
        <div class="quick-stats">
          <div class="quick-stat">
            <span class="quick-stat-value">8</span>
            <span class="quick-stat-label">å›½å†…ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</span>
          </div>
          <div class="quick-stat">
            <span class="quick-stat-value" id="overseas-count">8</span>
            <span class="quick-stat-label">æµ·å¤–ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼</span>
          </div>
          <div class="quick-stat">
            <span class="quick-stat-value" id="total-benchmark-followers">-</span>
            <span class="quick-stat-label">åˆè¨ˆãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
          </div>
          <div class="quick-stat">
            <span class="quick-stat-value" id="overseas-insights-count">-</span>
            <span class="quick-stat-label">æœ€æ–°ã‚¤ãƒ³ã‚µã‚¤ãƒˆ</span>
          </div>
        </div>
        
        <!-- æµ·å¤–ãƒªã‚µãƒ¼ãƒçµæœ -->
        <div class="section-header">
          <h2 class="section-title">ğŸŒ æµ·å¤–AIãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆGrokãƒªã‚µãƒ¼ãƒï¼‰</h2>
          <span class="section-badge" id="overseas-last-updated">æœªå–å¾—</span>
        </div>
        <div id="overseas-insights-list" class="card" style="margin-bottom: 24px;">
          <p style="color: var(--text-muted);">
            æµ·å¤–ãƒªã‚µãƒ¼ãƒã‚’å®Ÿè¡Œã™ã‚‹ã¨ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™<br>
            <code style="background: var(--bg-secondary); padding: 2px 6px; border-radius: 4px;">npm run research-overseas</code>
          </p>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ‘¤ å›½å†…ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</h2>
        </div>
        <div class="influencer-grid" id="influencer-list"></div>
      </div>

      <!-- ===== ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-schedule">
        <div class="section-header">
          <h2 class="section-title">â° æœ¬æ—¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h2>
        </div>
        <div class="schedule-grid" id="schedule-grid"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“… GitHub Actions ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h2>
        </div>
        <div class="card">
          <div id="github-actions-status">
            <p style="color: var(--text-secondary);">
              ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: <strong>X Marketing Automation</strong><br>
              ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ¯æ—¥ 06:00, 08:00, 09:00, 12:00, 20:00 (JST)<br><br>
              <a href="https://github.com/watchout/x-marketing-engine/actions" target="_blank" style="color: var(--accent-blue);">
                â†’ GitHub Actions ã‚’ç¢ºèª
              </a>
            </p>
          </div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ’¬ ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆ</h2>
        </div>
        <div id="reply-suggestions" class="card">
          <p style="color: var(--text-muted);">ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“ æŠ•ç¨¿ã‚­ãƒ¥ãƒ¼</h2>
        </div>
        <div id="post-queue" class="card">
          <p style="color: var(--text-muted);">æ¬¡å›æŠ•ç¨¿äºˆå®šã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>
        </div>
      </div>

      <!-- ===== ãƒ­ã‚°ã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-logs">
        <div class="section-header">
          <h2 class="section-title">ğŸ“‹ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°</h2>
        </div>
        <div class="card">
          <div class="activity-log" id="activity-log"></div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</h2>
        </div>
        <div class="grid-2">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">è¨­å®š</h3>
            </div>
            <div id="system-config"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">APIçŠ¶æ…‹</h3>
            </div>
            <div id="api-status"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // ===== ãƒ‡ãƒ¼ã‚¿ =====
    let postHistory = [];
    let systemStatus = 'unknown';
    
    const benchmarkAccounts = [
      { handle: '@masahirochaen', name: 'ãƒãƒ£ã‚¨ãƒ³ | ãƒ‡ã‚¸ãƒ©ã‚¤ã‚º CEO', followers: 150000, frequency: 'æ¯æ—¥1-3æŠ•ç¨¿', postingTime: 'æœ7-8æ™‚', tier: 1, style: 'AIãƒ‹ãƒ¥ãƒ¼ã‚¹æœ€é€Ÿç™ºä¿¡', learnFrom: ['é€Ÿå ±æ€§', 'æ¯æ—¥ã®ç¿’æ…£åŒ–', 'å®Ÿå‹™å¯„ã‚Šã®å†…å®¹'] },
      { handle: '@shota7180', name: 'æœ¨å†…ç¿”å¤§ | SHIFT AIä»£è¡¨', followers: 140000, frequency: 'é€±5-7æŠ•ç¨¿', postingTime: 'å¤•æ–¹-å¤œ', tier: 1, style: 'ãƒ¢ãƒãƒ™ç³»ï¼‹ãƒ„ãƒ¼ãƒ«Tips', learnFrom: ['ãƒ“ã‚¸ãƒ§ãƒ³èªã‚Š', 'ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å½¢æˆ'] },
      { handle: '@ai_jitan', name: 'ãˆãƒ¼ãŸã‚“ | AIÃ—æ™‚çŸ­', followers: 80000, frequency: 'æ¯æ—¥1-2æŠ•ç¨¿', postingTime: 'æœ10æ™‚-å¤•æ–¹', tier: 2, style: 'ãƒ„ãƒ¼ãƒ«æ´»ç”¨æ³•ã‚’å‹•ç”»ä»˜ãè§£èª¬', learnFrom: ['å‹•ç”»ãƒ‡ãƒ¢å¿…é ˆ', 'å†ç¾å¯èƒ½ãªæ‰‹é †', 'ã‚³ãƒ”ãƒšã§å®Œäº†'], priority: true, buzzRate: 'æœ€é«˜ï¼ˆä¸‡ãƒã‚ºè¤‡æ•°ï¼‰' },
      { handle: '@taziku_co', name: 'ç”°ä¸­ç¾©å¼˜ | AIÃ—Creative', followers: 50000, frequency: 'æ¯æ—¥', postingTime: 'å¤œä¸­å¿ƒ', tier: 2, style: 'ç”ŸæˆAIå‹•ç”»ãƒ»ã‚¢ãƒ‹ãƒ¡åˆ¶ä½œ', learnFrom: ['ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å¤šç”¨', 'ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–å¯„ã‚Š'] },
      { handle: '@Fujin_Metaverse', name: 'Fujin | AIè‡ªå‹•åŒ–', followers: 30000, frequency: 'æ¯æ—¥', postingTime: 'æœ-æ˜¼', tier: 3, style: 'AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ»è‡ªå‹•åŒ–ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—', learnFrom: ['ã‚¹ãƒ¬ãƒƒãƒ‰å½¢å¼', 'è©³ç´°ãªæ‰‹é †'] },
      { handle: '@commte', name: 'ã‚³ãƒ ãƒ† | Agentic AI', followers: 25000, frequency: 'é€±4-6', postingTime: 'æœ-å¤•æ–¹', tier: 3, style: 'Claude Code/Skill Marketplaceå®Ÿè·µ', learnFrom: ['æŠ€è¡“æ·±æ˜ã‚Š', 'é–‹ç™ºè€…å‘ã‘'] },
      { handle: '@akira_papa_IT', name: 'ã‚ãã‚‰ãƒ‘ãƒ‘ | ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢', followers: 20000, frequency: 'é€±3-5', postingTime: 'å¤•æ–¹-å¤œ', tier: 3, style: 'AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆçµ„ç¹”æ§‹ç¯‰', learnFrom: ['å‹•ç”»ä»˜ã', 'ã‚ã‹ã‚Šã‚„ã™ã„'] },
      { handle: '@ai_database', name: 'AIDB', followers: 30000, frequency: 'é€±3-5', postingTime: 'å¤•æ–¹', tier: 3, style: 'è«–æ–‡ãƒ™ãƒ¼ã‚¹ã®AIç§‘å­¦è§£èª¬', learnFrom: ['è«–æ–‡ãƒ™ãƒ¼ã‚¹', 'å›³è¡¨å¤šç”¨'] },
    ];

    // ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ =====
    function formatNumber(n) {
      if (n >= 1000000) return (n / 1000000).toFixed(1) + 'M';
      if (n >= 1000) return (n / 1000).toFixed(1) + 'K';
      return n.toString();
    }
    
    function formatDate(dateStr) {
      const d = new Date(dateStr);
      return d.toLocaleString('ja-JP', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
    }
    
    function getTypeClass(type) {
      const classes = {
        'tips': 'type-tips',
        'problem_statement': 'type-problem',
        'story': 'type-story',
        'discovery': 'type-discovery',
        'thread': 'type-thread',
        'before_after': 'type-discovery',
        'comparison': 'type-tips',
      };
      return classes[type] || 'type-tips';
    }
    
    function getTypeLabel(type) {
      const labels = {
        'tips': 'Tips',
        'problem_statement': 'å•é¡Œæèµ·',
        'story': 'ç‰©èª',
        'discovery': 'ç™ºè¦‹',
        'thread': 'ã‚¹ãƒ¬ãƒƒãƒ‰',
        'before_after': 'Before/After',
        'comparison': 'æ¯”è¼ƒ',
        'unknown': 'æœªåˆ†é¡'
      };
      return labels[type] || type;
    }
    
    function calculateER(post) {
      if (!post.metrics?.impressions || post.metrics.impressions === 0) return 0;
      const engagements = (post.metrics.likes || 0) + (post.metrics.retweets || 0) + (post.metrics.replies || 0);
      return (engagements / post.metrics.impressions * 100);
    }

    // ===== çµ±è¨ˆè¨ˆç®— =====
    function calculateStats(posts) {
      const total = posts.length;
      const impressions = posts.reduce((sum, p) => sum + (p.metrics?.impressions || 0), 0);
      const likes = posts.reduce((sum, p) => sum + (p.metrics?.likes || 0), 0);
      const retweets = posts.reduce((sum, p) => sum + (p.metrics?.retweets || 0), 0);
      const replies = posts.reduce((sum, p) => sum + (p.metrics?.replies || 0), 0);
      const engagements = likes + retweets + replies;
      const avgER = impressions > 0 ? (engagements / impressions * 100) : 0;
      
      // é€±é–“çµ±è¨ˆ
      const oneWeekAgo = new Date();
      oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
      const weekPosts = posts.filter(p => new Date(p.posted_at) > oneWeekAgo);
      const weekImpressions = weekPosts.reduce((sum, p) => sum + (p.metrics?.impressions || 0), 0);
      const weekLikes = weekPosts.reduce((sum, p) => sum + (p.metrics?.likes || 0), 0);
      
      // å‰é€±æ¯”è¼ƒ
      const twoWeeksAgo = new Date();
      twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
      const prevWeekPosts = posts.filter(p => {
        const d = new Date(p.posted_at);
        return d > twoWeeksAgo && d <= oneWeekAgo;
      });
      const prevWeekImpressions = prevWeekPosts.reduce((sum, p) => sum + (p.metrics?.impressions || 0), 0);
      
      return {
        total,
        impressions,
        likes,
        retweets,
        replies,
        engagements,
        avgER,
        weekPosts: weekPosts.length,
        weekImpressions,
        weekLikes,
        prevWeekImpressions,
        impressionChange: prevWeekImpressions > 0 ? ((weekImpressions - prevWeekImpressions) / prevWeekImpressions * 100) : 0
      };
    }

    // ===== ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° =====
    function renderMainStats(stats) {
      const container = document.getElementById('main-stats');
      container.innerHTML = `
        <div class="card stat-card">
          <div class="card-title">ç·æŠ•ç¨¿æ•°</div>
          <div class="value">${stats.total}</div>
          <div class="label">å…¨æœŸé–“</div>
          <div class="change neutral">ä»Šé€± ${stats.weekPosts} æŠ•ç¨¿</div>
        </div>
        <div class="card stat-card">
          <div class="card-title">ç·ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³</div>
          <div class="value">${formatNumber(stats.impressions)}</div>
          <div class="label">ç´¯è¨ˆ</div>
          <div class="change ${stats.impressionChange >= 0 ? 'up' : 'down'}">
            ${stats.impressionChange >= 0 ? 'â†‘' : 'â†“'} ${Math.abs(stats.impressionChange).toFixed(1)}% å‰é€±æ¯”
          </div>
        </div>
        <div class="card stat-card">
          <div class="card-title">ç·ã„ã„ã­</div>
          <div class="value">${stats.likes}</div>
          <div class="label">ç´¯è¨ˆ</div>
          <div class="change neutral">ä»Šé€± ${stats.weekLikes}</div>
        </div>
        <div class="card stat-card">
          <div class="card-title">å¹³å‡ER</div>
          <div class="value" style="color: ${stats.avgER >= 1 ? 'var(--accent-green)' : stats.avgER >= 0.5 ? 'var(--accent-orange)' : 'var(--accent-red)'}">${stats.avgER.toFixed(2)}%</div>
          <div class="label">ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡</div>
          <div class="change ${stats.avgER >= 1 ? 'up' : 'neutral'}">
            ç›®æ¨™: 1.0%ä»¥ä¸Š
          </div>
        </div>
      `;
    }
    
    function renderKPICards(stats) {
      const container = document.getElementById('kpi-cards');
      const kpis = [
        { label: 'é€±é–“ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³', current: stats.weekImpressions, target: 5000, unit: '' },
        { label: 'é€±é–“æŠ•ç¨¿æ•°', current: stats.weekPosts, target: 21, unit: 'æŠ•ç¨¿' },
        { label: 'ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡', current: stats.avgER, target: 1.0, unit: '%', isPercent: true },
      ];
      
      container.innerHTML = kpis.map(kpi => {
        const progress = Math.min((kpi.current / kpi.target) * 100, 100);
        const color = progress >= 80 ? 'var(--accent-green)' : progress >= 50 ? 'var(--accent-orange)' : 'var(--accent-red)';
        return `
          <div class="card">
            <div class="card-title">${kpi.label}</div>
            <div style="font-size: 28px; font-weight: 700; margin: 8px 0;">
              ${kpi.isPercent ? kpi.current.toFixed(2) : formatNumber(kpi.current)}${kpi.unit}
            </div>
            <div class="kpi-progress">
              <div class="kpi-bar">
                <div class="kpi-fill" style="width: ${progress}%; background: ${color};"></div>
              </div>
              <div class="kpi-labels">
                <span>é”æˆç‡: ${progress.toFixed(0)}%</span>
                <span>ç›®æ¨™: ${kpi.isPercent ? kpi.target.toFixed(1) : formatNumber(kpi.target)}${kpi.unit}</span>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }
    
    function renderTopPosts(posts) {
      const container = document.getElementById('top-posts');
      const sorted = [...posts]
        .filter(p => p.metrics?.impressions > 0)
        .sort((a, b) => (b.metrics?.impressions || 0) - (a.metrics?.impressions || 0))
        .slice(0, 3);
      
      if (sorted.length === 0) {
        container.innerHTML = '<p style="color: var(--text-muted);">ã¾ã ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã‚ã‚‹æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }
      
      container.innerHTML = sorted.map((post, i) => `
        <div class="post-card" style="border-left: 3px solid ${i === 0 ? 'var(--accent-orange)' : 'var(--border)'};">
          <div class="post-meta">
            <span>${formatDate(post.posted_at)}</span>
            <span class="post-type-badge ${getTypeClass(post.type)}">${getTypeLabel(post.type)}</span>
          </div>
          <div class="post-content">${post.content.substring(0, 200)}${post.content.length > 200 ? '...' : ''}</div>
          <div class="post-metrics">
            <span>ğŸ‘ï¸ ${formatNumber(post.metrics?.impressions || 0)}</span>
            <span>â¤ï¸ ${post.metrics?.likes || 0}</span>
            <span>ğŸ” ${post.metrics?.retweets || 0}</span>
            <span>ğŸ’¬ ${post.metrics?.replies || 0}</span>
            <span style="color: ${calculateER(post) >= 1 ? 'var(--accent-green)' : 'var(--text-muted)'};">ER: ${calculateER(post).toFixed(2)}%</span>
          </div>
        </div>
      `).join('');
    }
    
    function renderActionItems(stats) {
      const container = document.getElementById('action-items');
      const actions = [];
      
      if (stats.avgER < 0.5) {
        actions.push({ priority: 'high', title: 'ERæ”¹å–„ãŒå¿…è¦', desc: 'ãƒ•ãƒƒã‚¯å¼·åŒ–ãƒ»è³ªå•å½¢å¼ã®æŠ•ç¨¿ã‚’å¢—ã‚„ã™' });
      }
      if (stats.weekPosts < 14) {
        actions.push({ priority: 'medium', title: 'æŠ•ç¨¿é »åº¦ã‚’ä¸Šã’ã‚‹', desc: `ç¾åœ¨é€±${stats.weekPosts}æŠ•ç¨¿ â†’ ç›®æ¨™21æŠ•ç¨¿ï¼ˆ1æ—¥3å›ï¼‰` });
      }
      if (stats.weekImpressions < 1000) {
        actions.push({ priority: 'high', title: 'ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³å‘ä¸Š', desc: 'ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æŠ•ç¨¿ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å‚è€ƒã«ã™ã‚‹' });
      }
      
      actions.push({ priority: 'low', title: 'ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼ã¸ã®ãƒªãƒ—ãƒ©ã‚¤', desc: 'é–¢é€£æŠ•ç¨¿ã«ç©æ¥µçš„ã«ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆ1æ—¥10ä»¶ç›®æ¨™ï¼‰' });
      actions.push({ priority: 'low', title: 'ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ã‚’è©¦ã™', desc: 'ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°è§£èª¬ã§ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆå‘ä¸Š' });
      
      container.innerHTML = actions.map(a => `
        <div class="action-item">
          <div class="action-priority priority-${a.priority}"></div>
          <div class="action-content">
            <div class="action-title">${a.title}</div>
            <div class="action-desc">${a.desc}</div>
          </div>
        </div>
      `).join('');
    }
    
    function renderAlerts(stats) {
      const container = document.getElementById('alerts-container');
      const alerts = [];
      
      // æœ€æ–°æŠ•ç¨¿æ—¥ã‚’ç¢ºèª
      if (postHistory.length > 0) {
        const latestPost = new Date(postHistory[0].posted_at);
        const hoursSinceLastPost = (Date.now() - latestPost) / (1000 * 60 * 60);
        
        if (hoursSinceLastPost > 24) {
          alerts.push({
            type: 'warning',
            icon: 'âš ï¸',
            title: 'æŠ•ç¨¿ãŒåœæ­¢ã—ã¦ã„ã¾ã™',
            message: `æœ€çµ‚æŠ•ç¨¿ã‹ã‚‰${Math.floor(hoursSinceLastPost)}æ™‚é–“çµŒéã€‚GitHub Actionsã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`
          });
        }
      }
      
      if (stats.avgER < 0.3) {
        alerts.push({
          type: 'error',
          icon: 'ğŸš¨',
          title: 'ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ãŒä½ä¸‹',
          message: `ç¾åœ¨ã®ER ${stats.avgER.toFixed(2)}%ã€‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æˆ¦ç•¥ã®è¦‹ç›´ã—ã‚’æ¨å¥¨ã€‚`
        });
      }
      
      container.innerHTML = alerts.map(a => `
        <div class="alert alert-${a.type}">
          <div class="alert-icon">${a.icon}</div>
          <div class="alert-content">
            <h4>${a.title}</h4>
            <p>${a.message}</p>
          </div>
        </div>
      `).join('');
    }
    
    function renderPostsList(posts, filter = 'all') {
      const container = document.getElementById('posts-list');
      const quickStats = document.getElementById('posts-quick-stats');
      
      let filtered = posts;
      if (filter !== 'all') {
        filtered = posts.filter(p => p.type === filter);
      }
      
      // ã‚¿ã‚¤ãƒ—åˆ¥ã‚«ã‚¦ãƒ³ãƒˆ
      const typeCounts = {};
      posts.forEach(p => {
        const t = p.type || 'unknown';
        typeCounts[t] = (typeCounts[t] || 0) + 1;
      });
      
      quickStats.innerHTML = Object.entries(typeCounts)
        .sort((a, b) => b[1] - a[1])
        .map(([type, count]) => `
          <div class="quick-stat">
            <span class="quick-stat-value">${count}</span>
            <span class="quick-stat-label">${getTypeLabel(type)}</span>
          </div>
        `).join('');
      
      container.innerHTML = filtered.slice(0, 20).map(post => `
        <div class="post-card">
          <div class="post-meta">
            <span>${formatDate(post.posted_at)}</span>
            <div>
              <span class="post-type-badge ${getTypeClass(post.type)}">${getTypeLabel(post.type)}</span>
              <span style="margin-left: 8px; color: var(--text-muted);">${post.slot || '-'}</span>
            </div>
          </div>
          <div class="post-content">${post.content}</div>
          <div class="post-metrics">
            <span>ğŸ‘ï¸ ${formatNumber(post.metrics?.impressions || 0)}</span>
            <span>â¤ï¸ ${post.metrics?.likes || 0}</span>
            <span>ğŸ” ${post.metrics?.retweets || 0}</span>
            <span>ğŸ’¬ ${post.metrics?.replies || 0}</span>
            <span style="color: ${calculateER(post) >= 1 ? 'var(--accent-green)' : 'var(--text-muted)'};">
              ER: ${calculateER(post).toFixed(2)}%
            </span>
          </div>
        </div>
      `).join('');
      
      if (filtered.length > 20) {
        container.innerHTML += `<p style="text-align: center; color: var(--text-muted); padding: 20px;">+ ${filtered.length - 20} ä»¶ã®æŠ•ç¨¿</p>`;
      }
    }
    
    function renderTypePerformance(posts) {
      const container = document.getElementById('type-performance');
      const typeStats = {};
      
      posts.forEach(p => {
        const type = p.type || 'unknown';
        if (!typeStats[type]) {
          typeStats[type] = { count: 0, impressions: 0, likes: 0 };
        }
        typeStats[type].count++;
        typeStats[type].impressions += p.metrics?.impressions || 0;
        typeStats[type].likes += p.metrics?.likes || 0;
      });
      
      const sorted = Object.entries(typeStats)
        .map(([type, stats]) => ({
          type,
          ...stats,
          avgImp: stats.count > 0 ? stats.impressions / stats.count : 0,
          avgER: stats.impressions > 0 ? (stats.likes / stats.impressions * 100) : 0
        }))
        .sort((a, b) => b.avgImp - a.avgImp);
      
      const maxImp = Math.max(...sorted.map(s => s.avgImp), 1);
      
      container.innerHTML = `
        <div class="bar-chart">
          ${sorted.map(s => `
            <div class="bar-item">
              <div class="bar-value">${s.avgImp.toFixed(0)}</div>
              <div class="bar" style="height: ${(s.avgImp / maxImp) * 100}%; background: var(--accent-blue);"></div>
              <div class="bar-label">${getTypeLabel(s.type)}<br><span style="color: var(--text-muted);">(${s.count}ä»¶)</span></div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    function renderTimePerformance(posts) {
      const container = document.getElementById('time-performance');
      const slotStats = { morning: { count: 0, imp: 0 }, noon: { count: 0, imp: 0 }, night: { count: 0, imp: 0 } };
      
      posts.forEach(p => {
        const slot = p.slot || 'noon';
        if (slotStats[slot]) {
          slotStats[slot].count++;
          slotStats[slot].imp += p.metrics?.impressions || 0;
        }
      });
      
      const slots = [
        { key: 'morning', label: 'æœ (9:00)', ...slotStats.morning },
        { key: 'noon', label: 'æ˜¼ (12:00)', ...slotStats.noon },
        { key: 'night', label: 'å¤œ (20:00)', ...slotStats.night },
      ].map(s => ({ ...s, avg: s.count > 0 ? s.imp / s.count : 0 }));
      
      const maxAvg = Math.max(...slots.map(s => s.avg), 1);
      
      container.innerHTML = `
        <div class="bar-chart">
          ${slots.map(s => `
            <div class="bar-item">
              <div class="bar-value">${s.avg.toFixed(0)}</div>
              <div class="bar" style="height: ${(s.avg / maxAvg) * 100}%; background: var(--accent-purple);"></div>
              <div class="bar-label">${s.label}<br><span style="color: var(--text-muted);">(${s.count}ä»¶)</span></div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    function renderWeeklyTrend(posts) {
      const container = document.getElementById('weekly-trend');
      const weeks = {};
      
      posts.forEach(p => {
        const d = new Date(p.posted_at);
        const weekStart = new Date(d);
        weekStart.setDate(d.getDate() - d.getDay());
        const key = weekStart.toISOString().split('T')[0];
        
        if (!weeks[key]) weeks[key] = { posts: 0, imp: 0, likes: 0 };
        weeks[key].posts++;
        weeks[key].imp += p.metrics?.impressions || 0;
        weeks[key].likes += p.metrics?.likes || 0;
      });
      
      const sortedWeeks = Object.entries(weeks)
        .sort((a, b) => b[0].localeCompare(a[0]))
        .slice(0, 8)
        .reverse();
      
      const maxImp = Math.max(...sortedWeeks.map(w => w[1].imp), 1);
      
      container.innerHTML = `
        <div class="bar-chart" style="height: 180px;">
          ${sortedWeeks.map(([week, data]) => {
            const d = new Date(week);
            const label = `${d.getMonth()+1}/${d.getDate()}é€±`;
            return `
              <div class="bar-item">
                <div class="bar-value">${formatNumber(data.imp)}</div>
                <div class="bar" style="height: ${(data.imp / maxImp) * 100}%; background: linear-gradient(to top, var(--accent-blue), var(--accent-cyan));"></div>
                <div class="bar-label">${label}<br><span style="color: var(--text-muted);">${data.posts}æŠ•ç¨¿</span></div>
              </div>
            `;
          }).join('')}
        </div>
      `;
    }
    
    function renderWinningElements(posts) {
      const container = document.getElementById('winning-elements');
      const topPosts = [...posts]
        .filter(p => p.metrics?.impressions >= 50)
        .sort((a, b) => calculateER(b) - calculateER(a))
        .slice(0, 5);
      
      if (topPosts.length === 0) {
        container.innerHTML = '<p style="color: var(--text-muted);">åˆ†æã«ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }
      
      // å…±é€šè¦ç´ ã‚’æŠ½å‡º
      const elements = [];
      topPosts.forEach(p => {
        if (p.content.includes('ğŸ’¡') || p.content.includes('ğŸ”¥')) elements.push('çµµæ–‡å­—ä½¿ç”¨');
        if (p.content.match(/\n\n/)) elements.push('æ®µè½åˆ†ã‘');
        if (p.content.match(/#\w+/)) elements.push('ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°');
        if (p.content.match(/[ï¼Ÿ?]/)) elements.push('è³ªå•å½¢å¼');
        if (p.content.length < 140) elements.push('ç°¡æ½”ã•');
      });
      
      const counts = {};
      elements.forEach(e => counts[e] = (counts[e] || 0) + 1);
      
      container.innerHTML = Object.entries(counts)
        .sort((a, b) => b[1] - a[1])
        .map(([elem, count]) => `
          <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border);">
            <span>${elem}</span>
            <span style="color: var(--accent-green);">${count}ä»¶ã§ä½¿ç”¨</span>
          </div>
        `).join('');
    }
    
    function renderImprovementPoints(posts) {
      const container = document.getElementById('improvement-points');
      const points = [
        { issue: 'ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ä¸è¶³', solution: 'å‹•ç”»ãƒ»ã‚¹ã‚¯ã‚·ãƒ§ã®è¿½åŠ ã‚’æ¤œè¨' },
        { issue: 'æŠ•ç¨¿é »åº¦', solution: '1æ—¥3æŠ•ç¨¿ã‚’ç¶­æŒ' },
        { issue: 'ãƒ•ãƒƒã‚¯å¼±ã„', solution: 'ã€Œæ­£ç›´ã€ã€Œæ–­è¨€ã—ã¾ã™ã€ãªã©å¼·ã„è¨€è‘‰ã‚’ä½¿ã†' },
        { issue: 'ãƒªãƒ—ãƒ©ã‚¤ä¸è¶³', solution: 'ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼ã¸ã®ç©æ¥µçš„ãªã‚³ãƒ¡ãƒ³ãƒˆ' },
      ];
      
      container.innerHTML = points.map(p => `
        <div style="padding: 12px 0; border-bottom: 1px solid var(--border);">
          <div style="font-weight: 500; margin-bottom: 4px;">âš ï¸ ${p.issue}</div>
          <div style="font-size: 13px; color: var(--text-secondary);">â†’ ${p.solution}</div>
        </div>
      `).join('');
    }
    
    function renderOverseasInsights() {
      const container = document.getElementById('overseas-insights-list');
      const countEl = document.getElementById('overseas-insights-count');
      const updatedEl = document.getElementById('overseas-last-updated');
      
      if (!overseasInsights || !overseasInsights.ideas || overseasInsights.ideas.length === 0) {
        countEl.textContent = '-';
        return;
      }
      
      countEl.textContent = overseasInsights.ideas.length;
      
      // æœ€çµ‚æ›´æ–°æ—¥æ™‚
      const updatedAt = new Date(overseasInsights.researched_at);
      const hoursAgo = Math.round((Date.now() - updatedAt) / (1000 * 60 * 60));
      updatedEl.textContent = hoursAgo < 24 ? `${hoursAgo}æ™‚é–“å‰` : `${Math.round(hoursAgo/24)}æ—¥å‰`;
      
      container.innerHTML = `
        <div style="margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border);">
          <span style="color: var(--text-secondary); font-size: 13px;">
            ğŸ” ãƒªã‚µãƒ¼ãƒæ–¹æ³•: <strong>Grok</strong> | 
            ğŸ“… ${updatedAt.toLocaleString('ja-JP')} | 
            ğŸ¯ ${overseasInsights.topics_found || 0}ä»¶ã®ãƒˆãƒ”ãƒƒã‚¯ç™ºè¦‹
          </span>
        </div>
        ${overseasInsights.ideas.map(idea => {
          const noveltyColor = idea.insight.novelty_score >= 8 ? 'var(--accent-green)' : 
                               idea.insight.novelty_score >= 6 ? 'var(--accent-orange)' : 'var(--text-muted)';
          const noveltyEmoji = idea.insight.novelty_score >= 8 ? 'ğŸŒŸ' : idea.insight.novelty_score >= 6 ? 'âœ…' : 'ğŸ“';
          return `
            <div style="padding: 12px 0; border-bottom: 1px solid var(--border);">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <span style="font-weight: 600; color: var(--accent-cyan);">${idea.insight.topic}</span>
                <span style="color: ${noveltyColor}; font-size: 13px;">
                  ${noveltyEmoji} æ–°è¦æ€§: ${idea.insight.novelty_score}/10
                </span>
              </div>
              <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 8px;">
                ${idea.insight.summary}
              </p>
              <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                <span style="color: var(--text-muted); font-size: 12px;">ğŸ“ æ—¥æœ¬èªã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ¡ˆ:</span>
                <p style="color: var(--text-primary); margin-top: 4px; font-size: 14px;">
                  ${idea.japanese_adaptation}
                </p>
              </div>
              <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                ${idea.insight.key_accounts.map(acc => `
                  <a href="https://x.com/${acc.replace('@', '')}" target="_blank" 
                     style="color: var(--accent-blue); font-size: 12px; text-decoration: none;">
                    ${acc}
                  </a>
                `).join('')}
              </div>
            </div>
          `;
        }).join('')}
      `;
    }
    
    function renderReplySuggestions() {
      const container = document.getElementById('reply-suggestions');
      
      if (!replySuggestions || !replySuggestions.suggestions || replySuggestions.suggestions.length === 0) {
        container.innerHTML = `
          <p style="color: var(--text-muted);">
            ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚<br>
            <code style="font-size: 12px;">npm run suggest-replies</code> ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
          </p>
        `;
        return;
      }
      
      const pending = replySuggestions.suggestions.filter(s => !s.executed);
      const executed = replySuggestions.suggestions.filter(s => s.executed);
      
      container.innerHTML = `
        <div style="margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
          <span style="color: var(--text-secondary); font-size: 13px;">
            ğŸ“… ç”Ÿæˆ: ${new Date(replySuggestions.generated_at).toLocaleString('ja-JP')} |
            æœªå®Ÿè¡Œ: ${pending.length}ä»¶ | å®Ÿè¡Œæ¸ˆã¿: ${executed.length}ä»¶
          </span>
        </div>
        ${pending.length === 0 ? '<p style="color: var(--text-muted);">å…¨ã¦å®Ÿè¡Œæ¸ˆã¿ã§ã™ âœ…</p>' : ''}
        ${pending.map((s, i) => {
          const scoreEmoji = s.quality_score >= 8 ? 'ğŸŒŸ' : s.quality_score >= 6 ? 'âœ…' : 'ğŸ“';
          const relevanceColor = s.relevance === 'high' ? 'var(--accent-green)' : 
                                 s.relevance === 'medium' ? 'var(--accent-orange)' : 'var(--text-muted)';
          return `
            <div style="padding: 12px; margin-bottom: 8px; background: var(--bg-secondary); border-radius: 8px; border-left: 3px solid ${relevanceColor};">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <a href="${s.tweet.url}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-weight: 600;">
                  @${s.tweet.author}
                </a>
                <span style="font-size: 12px; color: var(--text-muted);">
                  ${scoreEmoji} ã‚¹ã‚³ã‚¢: ${s.quality_score}/10
                </span>
              </div>
              <div style="color: var(--text-secondary); font-size: 13px; margin-bottom: 8px; padding: 8px; background: var(--bg-card); border-radius: 4px;">
                "${s.tweet.text.substring(0, 80)}${s.tweet.text.length > 80 ? '...' : ''}"
              </div>
              <div style="background: var(--bg-card); padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                <span style="color: var(--accent-cyan); font-size: 12px;">ğŸ’¬ ææ¡ˆãƒªãƒ—ãƒ©ã‚¤:</span>
                <p style="color: var(--text-primary); margin-top: 4px; font-size: 14px;">${s.suggested_reply}</p>
              </div>
              <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <a href="${s.tweet.url}" target="_blank" 
                   style="padding: 6px 12px; background: var(--accent-blue); color: white; border-radius: 6px; text-decoration: none; font-size: 12px;">
                  ğŸ”— å…ƒãƒ„ã‚¤ãƒ¼ãƒˆ
                </a>
                <button onclick="copyReply('${encodeURIComponent(s.suggested_reply)}')"
                   style="padding: 6px 12px; background: var(--accent-green); color: white; border-radius: 6px; border: none; cursor: pointer; font-size: 12px;">
                  ğŸ“‹ ã‚³ãƒ”ãƒ¼
                </button>
              </div>
            </div>
          `;
        }).join('')}
        <div style="margin-top: 12px; padding: 10px; background: var(--bg-secondary); border-radius: 6px;">
          <span style="color: var(--text-muted); font-size: 12px;">
            ğŸ’¡ ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰å®Ÿè¡Œ: <code>npm run reply 0</code> (ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0ã‚’å®Ÿè¡Œ) ã¾ãŸã¯ <code>npm run reply all</code> (å…¨ã¦å®Ÿè¡Œ)
          </span>
        </div>
      `;
    }
    
    function copyReply(encodedText) {
      const text = decodeURIComponent(encodedText);
      navigator.clipboard.writeText(text).then(() => {
        alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
      });
    }
    
    function renderInfluencers() {
      const container = document.getElementById('influencer-list');
      const totalFollowers = benchmarkAccounts.reduce((sum, a) => sum + a.followers, 0);
      document.getElementById('total-benchmark-followers').textContent = formatNumber(totalFollowers);
      
      container.innerHTML = benchmarkAccounts.map(acc => `
        <div class="influencer-card ${acc.priority ? 'priority' : ''}">
          <div class="influencer-header">
            <a href="https://x.com/${acc.handle.replace('@', '')}" target="_blank" class="influencer-handle">${acc.handle}</a>
            <span class="tier-badge tier-${acc.tier}">Tier ${acc.tier}</span>
          </div>
          <div class="influencer-name">${acc.name}</div>
          <div class="influencer-stats">
            <span>ğŸ‘¥ ${formatNumber(acc.followers)}</span>
            <span>ğŸ“… ${acc.frequency}</span>
            <span>ğŸ• ${acc.postingTime}</span>
          </div>
          <div style="font-size: 12px; color: var(--text-muted); margin: 8px 0;">${acc.style}</div>
          ${acc.buzzRate ? `<div style="font-size: 11px; color: var(--accent-orange);">ğŸ”¥ ${acc.buzzRate}</div>` : ''}
          <div class="learn-points">
            <h4>å­¦ã¶ã¹ããƒã‚¤ãƒ³ãƒˆ</h4>
            ${acc.learnFrom.map(l => `<span class="tag">${l}</span>`).join('')}
          </div>
        </div>
      `).join('');
    }
    
    function renderSchedule() {
      const container = document.getElementById('schedule-grid');
      container.style.gridTemplateColumns = 'repeat(5, 1fr)';
      const now = new Date();
      const currentHour = now.getHours();
      
      const slots = [
        { time: '08:00', type: 'Tipså‹', icon: 'ğŸ’¡', hour: 8 },
        { time: '10:00', type: 'ç™ºè¦‹å‹', icon: 'ğŸ”', hour: 10 },
        { time: '12:00', type: 'ãƒã‚ºç‹™ã„', icon: 'ğŸ”¥', hour: 12 },
        { time: '18:00', type: 'å•é¡Œæèµ·', icon: 'â“', hour: 18 },
        { time: '21:00', type: 'ç‰©èªå‹', icon: 'ğŸ“–', hour: 21 },
      ];
      
      container.innerHTML = slots.map(slot => {
        const isCompleted = currentHour > slot.hour;
        const isNext = !isCompleted && currentHour < slot.hour;
        return `
          <div class="schedule-slot ${isCompleted ? 'completed' : ''} ${isNext && slots.filter(s => !isCompleted && currentHour < s.hour)[0] === slot ? 'next' : ''}">
            <div style="font-size: 24px; margin-bottom: 8px;">${slot.icon}</div>
            <div class="schedule-time">${slot.time}</div>
            <div class="schedule-type">${slot.type}</div>
            <div class="schedule-status" style="background: ${isCompleted ? 'var(--success)' : isNext ? 'var(--accent-blue)' : 'var(--bg-card)'};">
              ${isCompleted ? 'âœ“ å®Œäº†' : isNext ? 'â†’ æ¬¡å›' : 'äºˆå®š'}
            </div>
          </div>
        `;
      }).join('');
    }
    
    function renderActivityLog() {
      const container = document.getElementById('activity-log');
      
      // æŠ•ç¨¿å±¥æ­´ã‹ã‚‰ãƒ­ã‚°ã‚’ç”Ÿæˆ
      const logs = postHistory.slice(0, 15).map(p => ({
        time: new Date(p.posted_at),
        type: 'post',
        message: `æŠ•ç¨¿å®Œäº†: ${p.content.substring(0, 50)}...`
      }));
      
      // ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ãƒ­ã‚°ã‚’è¿½åŠ 
      const hasMetrics = postHistory.some(p => p.metrics?.collected_at);
      if (hasMetrics) {
        const latest = postHistory.find(p => p.metrics?.collected_at);
        if (latest) {
          logs.push({
            time: new Date(latest.metrics.collected_at),
            type: 'metrics',
            message: `ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†å®Œäº†: ${postHistory.length}ä»¶`
          });
        }
      }
      
      logs.sort((a, b) => b.time - a.time);
      
      if (logs.length === 0) {
        container.innerHTML = '<div style="padding: 20px; color: var(--text-muted); text-align: center;">ãƒ­ã‚°ãŒã‚ã‚Šã¾ã›ã‚“</div>';
        return;
      }
      
      container.innerHTML = logs.slice(0, 20).map(log => `
        <div class="log-entry">
          <span class="log-time">${log.time.toLocaleString('ja-JP')}</span>
          <span class="log-icon">${log.type === 'post' ? 'ğŸ“¤' : log.type === 'metrics' ? 'ğŸ“Š' : 'ğŸ”§'}</span>
          <span class="log-message">${log.message}</span>
        </div>
      `).join('');
    }
    
    function renderSystemInfo() {
      document.getElementById('system-config').innerHTML = `
        <div style="font-size: 13px; line-height: 2;">
          <div>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ: <strong>@ai_risukirin</strong></div>
          <div>æŠ•ç¨¿é »åº¦: <strong>1æ—¥3å›</strong></div>
          <div>LLM: <strong>GPT-4o + Gemini</strong></div>
          <div>Grok: <span style="color: var(--text-muted);">ã‚ªãƒ—ã‚·ãƒ§ãƒ³</span></div>
        </div>
      `;
      
      document.getElementById('api-status').innerHTML = `
        <div style="font-size: 13px; line-height: 2;">
          <div>X API: <span style="color: var(--accent-green);">âœ“ è¨­å®šæ¸ˆã¿</span></div>
          <div>OpenAI: <span style="color: var(--accent-green);">âœ“ è¨­å®šæ¸ˆã¿</span></div>
          <div>Google AI: <span style="color: var(--accent-green);">âœ“ è¨­å®šæ¸ˆã¿</span></div>
          <div>Grok: <span style="color: var(--text-muted);">æœªè¨­å®š</span></div>
        </div>
      `;
    }

    // ===== ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ =====
    // ç’°å¢ƒã«å¿œã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’é¸æŠ
    const isProduction = location.hostname !== 'localhost' && location.hostname !== '127.0.0.1';
    
    const DATA_SOURCES = {
      // Vercel/æœ¬ç•ªç’°å¢ƒç”¨: GitHub raw URLï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥å›é¿ã®ãŸã‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜åŠ ï¼‰
      github: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/data.json',
      github_overseas: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/overseas.json',
      github_account: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/account.json',
      github_replies: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/replies.json',
      // ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨
      local: './data.json',
      local_overseas: './overseas.json',
      local_account: './account.json'
    };
    
    let overseasInsights = null;
    let accountStats = null;
    let replySuggestions = null;
    
    async function loadData() {
      // æœ¬ç•ªç’°å¢ƒã§ã¯GitHubã‹ã‚‰ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰
      const sources = isProduction 
        ? [DATA_SOURCES.github + '?t=' + Date.now(), DATA_SOURCES.local]
        : [DATA_SOURCES.local, DATA_SOURCES.github];
      
      console.log('Environment:', isProduction ? 'Production' : 'Local');
      
      for (const url of sources) {
        try {
          console.log('Trying to load from:', url);
          const res = await fetch(url);
          if (res.ok) {
            postHistory = await res.json();
            systemStatus = 'active';
            console.log('âœ… Data loaded successfully from:', url.split('?')[0]);
            console.log('ğŸ“Š Posts count:', postHistory.length);
            break;
          } else {
            console.log('âŒ Failed with status:', res.status);
          }
        } catch (e) {
          console.log('âŒ Error loading from:', url, e.message);
        }
      }
      
      if (postHistory.length === 0) {
        console.error('Failed to load data from all sources');
        systemStatus = 'error';
      }
      
      // æµ·å¤–ã‚¤ãƒ³ã‚µã‚¤ãƒˆã‚’èª­ã¿è¾¼ã¿
      const overseasSources = isProduction 
        ? [DATA_SOURCES.github_overseas + '?t=' + Date.now(), DATA_SOURCES.local_overseas]
        : [DATA_SOURCES.local_overseas, DATA_SOURCES.github_overseas];
      
      for (const url of overseasSources) {
        try {
          const res = await fetch(url);
          if (res.ok) {
            overseasInsights = await res.json();
            console.log('âœ… Overseas insights loaded:', overseasInsights?.ideas?.length || 0, 'ideas');
            break;
          }
        } catch (e) {
          // æµ·å¤–ã‚¤ãƒ³ã‚µã‚¤ãƒˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
        }
      }
      
      // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçµ±è¨ˆã‚’èª­ã¿è¾¼ã¿
      const accountSources = isProduction 
        ? [DATA_SOURCES.github_account + '?t=' + Date.now(), DATA_SOURCES.local_account]
        : [DATA_SOURCES.local_account, DATA_SOURCES.github_account];
      
      for (const url of accountSources) {
        try {
          const res = await fetch(url);
          if (res.ok) {
            accountStats = await res.json();
            console.log('âœ… Account stats loaded:', accountStats?.followers_count, 'followers');
            break;
          }
        } catch (e) {
          // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçµ±è¨ˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
        }
      }
      
      // ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆã‚’èª­ã¿è¾¼ã¿
      try {
        const replyUrl = isProduction 
          ? DATA_SOURCES.github_replies + '?t=' + Date.now()
          : './replies.json';
        const res = await fetch(replyUrl);
        if (res.ok) {
          replySuggestions = await res.json();
          console.log('âœ… Reply suggestions loaded:', replySuggestions?.suggestions?.length || 0);
        }
      } catch (e) {
        // ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
      }
      
      // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
      const statusEl = document.getElementById('system-status');
      if (postHistory.length > 0) {
        const latestPost = new Date(postHistory[0].posted_at);
        const hoursSince = (Date.now() - latestPost) / (1000 * 60 * 60);
        
        if (hoursSince > 48) {
          statusEl.className = 'status-badge status-error';
          statusEl.textContent = 'æŠ•ç¨¿åœæ­¢ä¸­';
        } else if (hoursSince > 24) {
          statusEl.className = 'status-badge status-warning';
          statusEl.textContent = 'è¦ç¢ºèª';
        } else {
          statusEl.className = 'status-badge status-active';
          statusEl.textContent = 'ç¨¼åƒä¸­';
        }
      } else {
        statusEl.className = 'status-badge status-warning';
        statusEl.textContent = 'ãƒ‡ãƒ¼ã‚¿ãªã—';
      }
      
      document.getElementById('last-updated').textContent = `æ›´æ–°: ${new Date().toLocaleString('ja-JP')}`;
      
      // ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°ã‚’è¡¨ç¤º
      if (accountStats && accountStats.followers_count !== undefined) {
        document.getElementById('follower-number').textContent = accountStats.followers_count.toLocaleString();
      }
    }
    
    function render() {
      const stats = calculateStats(postHistory);
      
      renderMainStats(stats);
      renderKPICards(stats);
      renderTopPosts(postHistory);
      renderActionItems(stats);
      renderAlerts(stats);
      renderPostsList(postHistory);
      renderTypePerformance(postHistory);
      renderTimePerformance(postHistory);
      renderWeeklyTrend(postHistory);
      renderWinningElements(postHistory);
      renderImprovementPoints(postHistory);
      renderInfluencers();
      renderOverseasInsights();
      renderReplySuggestions();
      renderSchedule();
      renderActivityLog();
      renderSystemInfo();
    }

    // ===== ã‚¤ãƒ™ãƒ³ãƒˆ =====
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        tab.classList.add('active');
        document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
      });
    });
    
    document.getElementById('posts-filter').addEventListener('change', (e) => {
      renderPostsList(postHistory, e.target.value);
    });

    // ===== åˆæœŸåŒ– =====
    loadData().then(() => {
      render();
      document.getElementById('loading').style.display = 'none';
      document.getElementById('main-content').style.display = 'block';
    });
    
    // è‡ªå‹•æ›´æ–° (5åˆ†ã”ã¨)
    setInterval(() => {
      loadData().then(render);
    }, 300000);
  </script>
  </div><!-- end dashboard-wrapper -->

  <script>
    // ===== ç°¡æ˜“èªè¨¼ =====
    // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥ï¼ˆSHA-256ï¼‰ã‚’ä½¿ç”¨
    // å®Ÿéš›ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: devos2026
    const AUTH_HASH = '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918'; // 'admin'ã®ãƒãƒƒã‚·ãƒ¥ï¼ˆåˆæœŸå€¤ï¼‰
    
    async function hashPassword(password) {
      const encoder = new TextEncoder();
      const data = encoder.encode(password);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
    
    function checkAuth() {
      const authToken = sessionStorage.getItem('xme_auth');
      if (authToken === 'authenticated') {
        showDashboard();
        return true;
      }
      return false;
    }
    
    function showDashboard() {
      document.getElementById('auth-screen').style.display = 'none';
      document.getElementById('dashboard-wrapper').style.display = 'block';
    }
    
    document.getElementById('auth-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const password = document.getElementById('auth-password').value;
      const hash = await hashPassword(password);
      
      // è¨±å¯ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥
      const allowedHashes = [
        '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918', // admin
        'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', // 123
        '5e884898da28047d9171f37b05019f0d70f0e5e22e6e4c89d4f54ae4c0b60e6e', // password
        // ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ console.log(await hashPassword('your-password')) ã§å–å¾—
      ];
      
      if (allowedHashes.includes(hash)) {
        sessionStorage.setItem('xme_auth', 'authenticated');
        showDashboard();
      } else {
        document.getElementById('auth-error').classList.add('show');
        document.getElementById('auth-password').value = '';
        setTimeout(() => {
          document.getElementById('auth-error').classList.remove('show');
        }, 3000);
      }
    });
    
    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰å®Ÿè¡Œå¯èƒ½ï¼‰
    window.logout = function() {
      sessionStorage.removeItem('xme_auth');
      location.reload();
    };
    
    // åˆæœŸåŒ–æ™‚ã«èªè¨¼ãƒã‚§ãƒƒã‚¯
    if (!checkAuth()) {
      document.getElementById('auth-password').focus();
    }
  </script>
</body>
</html>
