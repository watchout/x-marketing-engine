<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>X Marketing Engine Dashboard</title>
  <style>
    :root {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-card: #21262d;
      --bg-hover: #30363d;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --accent-blue: #58a6ff;
      --accent-green: #3fb950;
      --accent-orange: #d29922;
      --accent-red: #f85149;
      --accent-purple: #a371f7;
      --accent-cyan: #79c0ff;
      --border: #30363d;
      --success: #238636;
      --warning: #9e6a03;
      --danger: #da3633;
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.5;
    }
    
    /* Auth Screen */
    .auth-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--bg-primary) 0%, #1a1f2e 100%);
    }
    
    .auth-box {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 40px;
      width: 100%;
      max-width: 400px;
      text-align: center;
    }
    
    .auth-box h1 {
      font-size: 24px;
      margin-bottom: 8px;
    }
    
    .auth-box p {
      color: var(--text-secondary);
      margin-bottom: 24px;
      font-size: 14px;
    }
    
    .auth-input {
      width: 100%;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 16px;
      margin-bottom: 16px;
      outline: none;
      transition: border-color 0.2s;
    }
    
    .auth-input:focus {
      border-color: var(--accent-blue);
    }
    
    .auth-input::placeholder {
      color: var(--text-muted);
    }
    
    .auth-btn {
      width: 100%;
      padding: 12px 24px;
      background: var(--accent-blue);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: opacity 0.2s;
    }
    
    .auth-btn:hover {
      opacity: 0.9;
    }
    
    .auth-error {
      color: var(--accent-red);
      font-size: 14px;
      margin-top: 12px;
      display: none;
    }
    
    .auth-error.show {
      display: block;
    }
    
    .container { max-width: 1400px; margin: 0 auto; padding: 24px; }
    
    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border);
    }
    
    .header h1 {
      font-size: 24px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .status-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
    }
    
    .status-active { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
    .status-warning { background: rgba(210, 153, 34, 0.15); color: var(--accent-orange); }
    .status-error { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
    
    .status-badge::before {
      content: '';
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: currentColor;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }
    
    .last-updated { color: var(--text-muted); font-size: 12px; }
    
    /* Navigation Tabs */
    .tabs {
      display: flex;
      gap: 4px;
      margin-bottom: 24px;
      border-bottom: 1px solid var(--border);
      padding-bottom: 0;
    }
    
    .tab {
      padding: 12px 20px;
      cursor: pointer;
      color: var(--text-secondary);
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      font-size: 14px;
    }
    
    .tab:hover { color: var(--text-primary); }
    .tab.active { color: var(--accent-blue); border-bottom-color: var(--accent-blue); }
    
    /* Tab Content */
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    
    /* Grid Layouts */
    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
    .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px; }
    
    @media (max-width: 1200px) { .grid-4 { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 768px) { 
      .grid-4, .grid-3, .grid-2 { grid-template-columns: 1fr; }
    }
    
    /* Cards */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px;
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .card-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .card-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 12px;
      font-weight: 500;
    }
    
    /* Stats Cards */
    .stat-card .value {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    
    .stat-card .label {
      color: var(--text-secondary);
      font-size: 13px;
    }
    
    .stat-card .change {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 4px;
      margin-top: 8px;
    }
    
    .change.up { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
    .change.down { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
    .change.neutral { background: rgba(139, 148, 158, 0.15); color: var(--text-secondary); }
    
    /* KPI Progress */
    .kpi-progress {
      margin-top: 12px;
    }
    
    .kpi-bar {
      height: 6px;
      background: var(--bg-hover);
      border-radius: 3px;
      overflow: hidden;
    }
    
    .kpi-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s ease;
    }
    
    .kpi-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 6px;
      font-size: 11px;
      color: var(--text-muted);
    }
    
    /* Section Headers */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 32px 0 16px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border);
    }
    
    .section-title {
      font-size: 18px;
      font-weight: 600;
    }
    
    /* Tables */
    .table-container {
      overflow-x: auto;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    
    th {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
    }
    
    tr:hover { background: var(--bg-hover); }
    
    /* Post Cards */
    .post-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 12px;
    }
    
    .post-meta {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 12px;
      color: var(--text-muted);
    }
    
    .post-content {
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 12px;
      white-space: pre-wrap;
    }
    
    .post-metrics {
      display: flex;
      gap: 20px;
      font-size: 13px;
      color: var(--text-secondary);
    }
    
    .post-metrics span {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .post-type-badge {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .type-tips { background: rgba(88, 166, 255, 0.15); color: var(--accent-blue); }
    .type-problem { background: rgba(248, 81, 73, 0.15); color: var(--accent-red); }
    .type-story { background: rgba(163, 113, 247, 0.15); color: var(--accent-purple); }
    .type-discovery { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
    .type-thread { background: rgba(210, 153, 34, 0.15); color: var(--accent-orange); }
    
    /* Influencer Cards */
    .influencer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 16px;
    }
    
    .influencer-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      transition: transform 0.2s, border-color 0.2s;
    }
    
    .influencer-card:hover {
      transform: translateY(-2px);
      border-color: var(--accent-blue);
    }
    
    .influencer-card.priority { border-color: var(--accent-orange); }
    
    .influencer-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }
    
    .influencer-handle {
      font-weight: 600;
      color: var(--accent-blue);
    }
    
    .tier-badge {
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 4px;
      font-weight: 600;
    }
    
    .tier-1 { background: linear-gradient(135deg, #ffd700, #ffb347); color: #000; }
    .tier-2 { background: linear-gradient(135deg, #c0c0c0, #a8a8a8); color: #000; }
    .tier-3 { background: linear-gradient(135deg, #cd7f32, #a0522d); color: #fff; }
    
    .influencer-name {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }
    
    .influencer-stats {
      display: flex;
      gap: 16px;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }
    
    .learn-points {
      padding-top: 12px;
      border-top: 1px solid var(--border);
    }
    
    .learn-points h4 {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 8px;
      text-transform: uppercase;
    }
    
    .tag {
      display: inline-block;
      font-size: 11px;
      padding: 3px 8px;
      background: var(--bg-card);
      border-radius: 4px;
      margin: 2px;
    }
    
    /* Schedule */
    .schedule-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
    
    .schedule-slot {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }
    
    .schedule-slot.next { border-color: var(--accent-green); }
    .schedule-slot.completed { opacity: 0.6; }
    
    .schedule-time {
      font-size: 28px;
      font-weight: 700;
      color: var(--accent-blue);
    }
    
    .schedule-type {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
    }
    
    .schedule-status {
      font-size: 11px;
      margin-top: 8px;
      padding: 4px 12px;
      border-radius: 12px;
      display: inline-block;
    }
    
    /* Analysis Charts */
    .chart-placeholder {
      height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-secondary);
      border-radius: 8px;
      color: var(--text-muted);
    }
    
    .bar-chart {
      display: flex;
      align-items: flex-end;
      gap: 8px;
      height: 150px;
      padding: 16px 0;
    }
    
    .bar-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .bar {
      width: 100%;
      max-width: 40px;
      background: var(--accent-blue);
      border-radius: 4px 4px 0 0;
      min-height: 4px;
      transition: height 0.5s ease;
    }
    
    .bar-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 8px;
      text-align: center;
    }
    
    .bar-value {
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    /* Activity Log */
    .activity-log {
      max-height: 400px;
      overflow-y: auto;
    }
    
    .log-entry {
      display: flex;
      gap: 12px;
      padding: 12px;
      border-bottom: 1px solid var(--border);
      font-size: 13px;
    }
    
    .log-time {
      color: var(--text-muted);
      min-width: 140px;
    }
    
    .log-icon {
      width: 20px;
      text-align: center;
    }
    
    .log-message { flex: 1; }
    
    /* Alerts */
    .alert {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    
    .alert-warning { background: rgba(210, 153, 34, 0.1); border: 1px solid var(--accent-orange); }
    .alert-error { background: rgba(248, 81, 73, 0.1); border: 1px solid var(--accent-red); }
    .alert-success { background: rgba(63, 185, 80, 0.1); border: 1px solid var(--accent-green); }
    
    .alert-icon { font-size: 18px; }
    .alert-content h4 { font-size: 14px; margin-bottom: 4px; }
    .alert-content p { font-size: 13px; color: var(--text-secondary); }
    
    /* Action Items */
    .action-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      margin-bottom: 8px;
    }
    
    .action-priority {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }
    
    .priority-high { background: var(--accent-red); }
    .priority-medium { background: var(--accent-orange); }
    .priority-low { background: var(--accent-blue); }
    
    .action-content { flex: 1; }
    .action-title { font-size: 14px; font-weight: 500; }
    .action-desc { font-size: 12px; color: var(--text-secondary); }

    /* Quick Stats Row */
    .quick-stats {
      display: flex;
      gap: 24px;
      padding: 16px 20px;
      background: var(--bg-secondary);
      border-radius: 8px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    
    .quick-stat {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .quick-stat-value { font-weight: 600; }
    .quick-stat-label { color: var(--text-muted); font-size: 13px; }

    /* Account Buttons */
    .account-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .account-btn:hover { border-color: var(--accent-blue); background: rgba(88,166,255,0.08); }
    .account-btn.active { border-color: var(--accent-blue); background: rgba(88,166,255,0.15); color: var(--accent-blue); }

    .account-btn-name { font-weight: 600; }

    .account-btn-count {
      font-size: 11px;
      background: var(--bg-hover);
      padding: 1px 6px;
      border-radius: 10px;
      color: var(--text-muted);
    }

    .account-btn.active .account-btn-count { background: rgba(88,166,255,0.2); color: var(--accent-blue); }

    .account-btn-remove {
      font-size: 14px;
      color: var(--text-muted);
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s;
      margin-left: 2px;
    }

    .account-btn:hover .account-btn-remove { opacity: 1; }
    .account-btn-remove:hover { color: var(--accent-red); }

    /* Influencer Watch Form */
    .watch-form-container {
      max-width: 800px;
    }

    .watch-input-group {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
    }

    .watch-input {
      flex: 1;
      padding: 10px 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s;
    }

    .watch-input:focus { border-color: var(--accent-blue); }
    .watch-input::placeholder { color: var(--text-muted); }

    .watch-select {
      padding: 10px 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 14px;
      outline: none;
      min-width: 160px;
    }

    .watch-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: opacity 0.2s;
      white-space: nowrap;
    }

    .watch-btn:hover { opacity: 0.9; }
    .watch-btn-primary { background: var(--accent-blue); color: white; }
    .watch-btn-success { background: var(--accent-green); color: white; }
    .watch-btn-danger { background: var(--accent-red); color: white; font-size: 12px; padding: 6px 10px; }
    .watch-btn-small { background: var(--bg-hover); color: var(--text-primary); font-size: 12px; padding: 6px 12px; }

    .watch-textarea {
      width: 100%;
      min-height: 120px;
      padding: 12px 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 14px;
      font-family: inherit;
      outline: none;
      resize: vertical;
      transition: border-color 0.2s;
    }

    .watch-textarea:focus { border-color: var(--accent-blue); }
    .watch-textarea::placeholder { color: var(--text-muted); }

    .saved-post-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 14px;
      margin-bottom: 10px;
      transition: border-color 0.2s;
    }

    .saved-post-card:hover { border-color: var(--accent-blue); }

    .saved-post-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .saved-post-handle {
      font-weight: 600;
      color: var(--accent-blue);
      font-size: 14px;
    }

    .saved-post-date {
      font-size: 12px;
      color: var(--text-muted);
    }

    .saved-post-content {
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-secondary);
      margin-bottom: 8px;
      white-space: pre-wrap;
    }

    .saved-post-metrics {
      display: flex;
      gap: 16px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .influencer-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 20px;
      font-size: 13px;
      margin: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .influencer-tag:hover { border-color: var(--accent-blue); }
    .influencer-tag.active { background: rgba(88, 166, 255, 0.15); border-color: var(--accent-blue); color: var(--accent-blue); }

    .influencer-tag .remove-tag {
      cursor: pointer;
      color: var(--text-muted);
      font-size: 16px;
      line-height: 1;
    }

    .influencer-tag .remove-tag:hover { color: var(--accent-red); }

    /* Loading */
    #loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 50vh;
      gap: 16px;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid var(--border);
      border-top-color: var(--accent-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Auth Screen -->
  <div id="auth-screen" class="auth-screen">
    <div class="auth-box">
      <h1>ğŸ” X Marketing Dashboard</h1>
      <p>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
      <form id="auth-form">
        <input type="password" id="auth-password" class="auth-input" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" autocomplete="current-password">
        <button type="submit" class="auth-btn">ãƒ­ã‚°ã‚¤ãƒ³</button>
        <p id="auth-error" class="auth-error">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“</p>
      </form>
    </div>
  </div>

  <!-- Main Dashboard -->
  <div id="dashboard-wrapper" style="display: none;">
  <div class="container">
    <header class="header">
      <h1>
        <span style="font-size: 28px;">ğŸ“Š</span>
        X Marketing Engine
      </h1>
      <div class="header-right">
        <a href="settings.html" style="display: flex; align-items: center; gap: 6px; padding: 6px 12px; background: var(--bg-card); border-radius: 20px; font-size: 14px; color: var(--text-primary); text-decoration: none; border: 1px solid var(--border); transition: border-color 0.2s;" onmouseover="this.style.borderColor='var(--accent-blue)'" onmouseout="this.style.borderColor='var(--border)'">
          <span>âš™ï¸</span>
          <span>è¨­å®š</span>
        </a>
        <div id="follower-count" style="display: flex; align-items: center; gap: 8px; padding: 6px 12px; background: var(--bg-card); border-radius: 20px; font-size: 14px;">
          <span style="color: var(--accent-blue);">ğŸ‘¥</span>
          <span id="follower-number" style="font-weight: 600;">-</span>
          <span style="color: var(--text-secondary);">ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
        </div>
        <div class="status-badge status-warning" id="system-status">
          ç¢ºèªä¸­...
        </div>
        <div class="last-updated" id="last-updated">-</div>
      </div>
    </header>

    <div class="tabs">
      <div class="tab active" data-tab="overview">æ¦‚è¦</div>
      <div class="tab" data-tab="posts">æŠ•ç¨¿ä¸€è¦§</div>
      <div class="tab" data-tab="analysis">åˆ†æ</div>
      <div class="tab" data-tab="benchmark">ğŸ”¬ ãƒªã‚µãƒ¼ãƒ</div>
      <div class="tab" data-tab="schedule">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</div>
      <div class="tab" data-tab="logs">ãƒ­ã‚°</div>
    </div>

    <div id="loading">
      <div class="spinner"></div>
      <div style="color: var(--text-muted);">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>

    <div id="main-content" style="display: none;">
      
      <!-- ===== æ¦‚è¦ã‚¿ãƒ– ===== -->
      <div class="tab-content active" id="tab-overview">
        <div id="alerts-container"></div>
        
        <div class="grid-4" id="main-stats"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“ˆ KPIé”æˆçŠ¶æ³</h2>
        </div>
        <div class="grid-3" id="kpi-cards"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ† ãƒˆãƒƒãƒ—ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŠ•ç¨¿</h2>
        </div>
        <div id="top-posts"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“‹ æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h2>
        </div>
        <div id="action-items"></div>
      </div>

      <!-- ===== æŠ•ç¨¿ä¸€è¦§ã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-posts">
        <div class="quick-stats" id="posts-quick-stats"></div>

        <!-- æŠ•ç¨¿äºˆå®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="section-header">
          <h2 class="section-title">ğŸ“… æŠ•ç¨¿äºˆå®š</h2>
          <select id="schedule-range" style="background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); padding: 8px 12px; border-radius: 6px;">
            <option value="7">ä»Šå¾Œ7æ—¥é–“</option>
            <option value="3">ä»Šå¾Œ3æ—¥é–“</option>
            <option value="14">ä»Šå¾Œ14æ—¥é–“</option>
          </select>
        </div>
        <div id="scheduled-posts-list"></div>

        <div style="margin-top: 24px;"></div>

        <div class="section-header">
          <h2 class="section-title">æŠ•ç¨¿å±¥æ­´</h2>
          <select id="posts-filter" style="background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border); padding: 8px 12px; border-radius: 6px;">
            <option value="all">ã™ã¹ã¦</option>
            <option value="tips">Tipså‹</option>
            <option value="problem_statement">å•é¡Œæèµ·å‹</option>
            <option value="story">ç‰©èªå‹</option>
            <option value="discovery">ç™ºè¦‹å‹</option>
            <option value="thread">ã‚¹ãƒ¬ãƒƒãƒ‰</option>
          </select>
        </div>
        <div id="posts-list"></div>
      </div>

      <!-- ===== åˆ†æã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-analysis">
        <div class="grid-2">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">æŠ•ç¨¿ã‚¿ã‚¤ãƒ—åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h3>
            </div>
            <div id="type-performance"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">æ™‚é–“å¸¯åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h3>
            </div>
            <div id="time-performance"></div>
          </div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“Š é€±æ¬¡ãƒˆãƒ¬ãƒ³ãƒ‰</h2>
        </div>
        <div class="card">
          <div id="weekly-trend"></div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ” ã‚³ãƒ³ãƒ†ãƒ³ãƒ„åˆ†æ</h2>
        </div>
        <div class="grid-2">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ç´ </h3>
            </div>
            <div id="winning-elements"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">æ”¹å–„ãƒã‚¤ãƒ³ãƒˆ</h3>
            </div>
            <div id="improvement-points"></div>
          </div>
        </div>
      </div>

      <!-- ===== ãƒªã‚µãƒ¼ãƒã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-benchmark">
        <div class="quick-stats">
          <div class="quick-stat">
            <span class="quick-stat-value" id="watch-total-influencers">0</span>
            <span class="quick-stat-label">ç›£è¦–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</span>
          </div>
          <div class="quick-stat">
            <span class="quick-stat-value" id="watch-total-posts">0</span>
            <span class="quick-stat-label">åé›†æŠ•ç¨¿æ•°</span>
          </div>
          <div class="quick-stat">
            <span class="quick-stat-value" id="watch-analyzed">0</span>
            <span class="quick-stat-label">åˆ†ææ¸ˆã¿</span>
          </div>
          <div class="quick-stat">
            <span class="quick-stat-value" id="overseas-insights-count">-</span>
            <span class="quick-stat-label">æµ·å¤–ã‚¤ãƒ³ã‚µã‚¤ãƒˆ</span>
          </div>
        </div>

        <!-- â‘  ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€è¦§ï¼ˆãƒœã‚¿ãƒ³å½¢å¼ï¼‰ -->
        <div class="section-header">
          <h2 class="section-title">ğŸ‘¤ ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</h2>
          <div style="display: flex; gap: 8px;">
            <button class="watch-btn watch-btn-small" onclick="toggleAddForm()" id="toggle-add-btn">ï¼‹ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¿½åŠ </button>
          </div>
        </div>
        <!-- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆéè¡¨ç¤ºï¼‰ -->
        <div class="card" id="add-influencer-form" style="display: none; margin-bottom: 16px;">
          <div class="watch-input-group">
            <input type="text" class="watch-input" id="new-influencer-handle" placeholder="@handle" style="max-width: 200px;">
            <input type="text" class="watch-input" id="new-influencer-category" placeholder="ãƒ¡ãƒ¢ï¼ˆä¾‹: AIæ´»ç”¨ï¼‰" style="max-width: 200px;">
            <select class="watch-select" id="new-influencer-genre" style="min-width: 160px;"></select>
            <button class="watch-btn watch-btn-primary" onclick="addInfluencer()">è¿½åŠ </button>
          </div>
        </div>
        <!-- ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ã‚°ãƒªãƒƒãƒ‰ -->
        <div id="genre-account-grid"></div>

        <!-- â‘¡ æŠ•ç¨¿å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="section-header" style="margin-top: 24px;">
          <h2 class="section-title">ğŸ“ ãƒã‚ºæŠ•ç¨¿ã‚’å…¥åŠ›</h2>
          <div style="display: flex; gap: 8px;">
            <button class="watch-btn watch-btn-small" onclick="setInputMode('url')" id="mode-url-btn" style="border: 1px solid var(--accent-blue); color: var(--accent-blue);">URLå…¥åŠ›</button>
            <button class="watch-btn watch-btn-small" onclick="setInputMode('text')" id="mode-text-btn">ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›</button>
          </div>
        </div>
        <div class="card watch-form-container">
          <!-- é¸æŠä¸­ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤º -->
          <div id="selected-account-banner" style="display: none; margin-bottom: 12px; padding: 8px 14px; background: rgba(88,166,255,0.1); border: 1px solid var(--accent-blue); border-radius: 8px; font-size: 14px;">
            æŠ•ç¨¿å…ˆ: <strong id="selected-account-name" style="color: var(--accent-blue);"></strong>
            <button onclick="clearSelectedAccount()" style="background: none; border: none; color: var(--text-muted); cursor: pointer; margin-left: 8px; font-size: 16px;">&times;</button>
          </div>

          <!-- URLå…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ -->
          <div id="input-mode-url">
            <div class="watch-input-group">
              <input type="text" class="watch-input" id="watch-url-input" placeholder="https://x.com/user/status/... ã‚’è²¼ã‚Šä»˜ã‘" style="flex: 1;">
              <button class="watch-btn watch-btn-primary" onclick="addPostByUrl()">è¿½åŠ </button>
            </div>
          </div>

          <!-- ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ãƒ¢ãƒ¼ãƒ‰ -->
          <div id="input-mode-text" style="display: none;">
            <div class="watch-input-group" style="flex-wrap: wrap; margin-bottom: 8px;">
              <input type="number" class="watch-input" id="watch-text-likes" placeholder="â¤ï¸ ã„ã„ã­" style="max-width: 110px;">
              <input type="number" class="watch-input" id="watch-text-rts" placeholder="ğŸ” RT" style="max-width: 110px;">
              <input type="number" class="watch-input" id="watch-text-impressions" placeholder="ğŸ‘ï¸ imp" style="max-width: 110px;">
              <input type="text" class="watch-input" id="watch-text-url" placeholder="å…ƒURLï¼ˆä»»æ„ï¼‰" style="max-width: 280px;">
            </div>
            <textarea class="watch-textarea" id="watch-text-content" placeholder="æŠ•ç¨¿ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã‚Šä»˜ã‘..."></textarea>
            <div style="margin-top: 8px; text-align: right;">
              <button class="watch-btn watch-btn-primary" onclick="addPostByText()">è¿½åŠ </button>
            </div>
          </div>
        </div>

        <!-- â‘¢ ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
        <div style="margin: 16px 0; display: flex; gap: 12px; align-items: center;">
          <button class="watch-btn watch-btn-success" onclick="analyzeAllPosts()" id="analyze-all-btn">
            ğŸ¤– æœªåˆ†æã‚’AIåˆ†æ
          </button>
          <button class="watch-btn watch-btn-small" onclick="exportWatchData()">
            ğŸ“¥ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
          </button>
          <span id="analyze-status" style="font-size: 13px; color: var(--text-muted);"></span>
        </div>

        <!-- â‘£ åé›†æ¸ˆã¿æŠ•ç¨¿ä¸€è¦§ -->
        <div class="section-header">
          <h2 class="section-title">ğŸ“‹ åé›†æ¸ˆã¿æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h2>
          <select class="watch-select" id="watch-filter-influencer" onchange="renderWatchPosts()" style="min-width: 140px;">
            <option value="all">å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</option>
          </select>
        </div>
        <div id="watch-posts-list"></div>

        <!-- â‘¤ æµ·å¤–ãƒªã‚µãƒ¼ãƒçµæœ -->
        <div class="section-header" style="margin-top: 32px;">
          <h2 class="section-title">ğŸŒ æµ·å¤–AIãƒˆãƒ¬ãƒ³ãƒ‰ï¼ˆè‡ªå‹•ãƒªã‚µãƒ¼ãƒï¼‰</h2>
          <span class="section-badge" id="overseas-last-updated">æœªå–å¾—</span>
        </div>
        <div id="overseas-insights-list" class="card" style="margin-bottom: 24px;">
          <p style="color: var(--text-muted);">
            æµ·å¤–ãƒªã‚µãƒ¼ãƒã‚’å®Ÿè¡Œã™ã‚‹ã¨ã“ã“ã«çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™<br>
            <code style="background: var(--bg-secondary); padding: 2px 6px; border-radius: 4px;">npm run research-overseas</code>
          </p>
        </div>
      </div>

      <!-- ===== ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-schedule">
        <div class="section-header">
          <h2 class="section-title">â° æœ¬æ—¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h2>
        </div>
        <div class="schedule-grid" id="schedule-grid"></div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“… GitHub Actions ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h2>
        </div>
        <div class="card">
          <div id="github-actions-status">
            <p style="color: var(--text-secondary);">
              ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: <strong>X Marketing Automation</strong><br>
              ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: æ¯æ—¥ 06:00, 08:00, 09:00, 12:00, 20:00 (JST)<br><br>
              <a href="https://github.com/watchout/x-marketing-engine/actions" target="_blank" style="color: var(--accent-blue);">
                â†’ GitHub Actions ã‚’ç¢ºèª
              </a>
            </p>
          </div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ’¬ ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆ</h2>
        </div>
        <div id="reply-suggestions" class="card">
          <p style="color: var(--text-muted);">ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ“ æŠ•ç¨¿ã‚­ãƒ¥ãƒ¼</h2>
        </div>
        <div id="post-queue" class="card">
          <p style="color: var(--text-muted);">æ¬¡å›æŠ•ç¨¿äºˆå®šã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</p>
        </div>
      </div>

      <!-- ===== ãƒ­ã‚°ã‚¿ãƒ– ===== -->
      <div class="tab-content" id="tab-logs">
        <div class="section-header">
          <h2 class="section-title">ğŸ“‹ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°</h2>
        </div>
        <div class="card">
          <div class="activity-log" id="activity-log"></div>
        </div>
        
        <div class="section-header">
          <h2 class="section-title">ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</h2>
        </div>
        <div class="grid-2">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">è¨­å®š</h3>
            </div>
            <div id="system-config"></div>
          </div>
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">APIçŠ¶æ…‹</h3>
            </div>
            <div id="api-status"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // ===== ãƒ‡ãƒ¼ã‚¿ =====
    let postHistory = [];
    let scheduledPosts = [];
    let systemStatus = 'unknown';
    
    // benchmarkAccounts ã¯ influencer_watch.json + localStorage ã«çµ±åˆæ¸ˆã¿

    // ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ =====
    function formatNumber(n) {
      if (n >= 1000000) return (n / 1000000).toFixed(1) + 'M';
      if (n >= 1000) return (n / 1000).toFixed(1) + 'K';
      return n.toString();
    }
    
    function formatDate(dateStr) {
      const d = new Date(dateStr);
      return d.toLocaleString('ja-JP', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
    }
    
    function getTypeClass(type) {
      const classes = {
        'tips': 'type-tips',
        'problem_statement': 'type-problem',
        'story': 'type-story',
        'discovery': 'type-discovery',
        'thread': 'type-thread',
        'before_after': 'type-discovery',
        'comparison': 'type-tips',
      };
      return classes[type] || 'type-tips';
    }
    
    function getTypeLabel(type) {
      const labels = {
        'tips': 'Tips',
        'problem_statement': 'å•é¡Œæèµ·',
        'story': 'ç‰©èª',
        'discovery': 'ç™ºè¦‹',
        'thread': 'ã‚¹ãƒ¬ãƒƒãƒ‰',
        'before_after': 'Before/After',
        'comparison': 'æ¯”è¼ƒ',
        'unknown': 'æœªåˆ†é¡'
      };
      return labels[type] || type;
    }
    
    function calculateER(post) {
      if (!post.metrics?.impressions || post.metrics.impressions === 0) return 0;
      const engagements = (post.metrics.likes || 0) + (post.metrics.retweets || 0) + (post.metrics.replies || 0);
      return (engagements / post.metrics.impressions * 100);
    }

    // ===== çµ±è¨ˆè¨ˆç®— =====
    function calculateStats(posts) {
      const total = posts.length;
      const impressions = posts.reduce((sum, p) => sum + (p.metrics?.impressions || 0), 0);
      const likes = posts.reduce((sum, p) => sum + (p.metrics?.likes || 0), 0);
      const retweets = posts.reduce((sum, p) => sum + (p.metrics?.retweets || 0), 0);
      const replies = posts.reduce((sum, p) => sum + (p.metrics?.replies || 0), 0);
      const engagements = likes + retweets + replies;
      const avgER = impressions > 0 ? (engagements / impressions * 100) : 0;
      
      // é€±é–“çµ±è¨ˆ
      const oneWeekAgo = new Date();
      oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
      const weekPosts = posts.filter(p => new Date(p.posted_at) > oneWeekAgo);
      const weekImpressions = weekPosts.reduce((sum, p) => sum + (p.metrics?.impressions || 0), 0);
      const weekLikes = weekPosts.reduce((sum, p) => sum + (p.metrics?.likes || 0), 0);
      
      // å‰é€±æ¯”è¼ƒ
      const twoWeeksAgo = new Date();
      twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
      const prevWeekPosts = posts.filter(p => {
        const d = new Date(p.posted_at);
        return d > twoWeeksAgo && d <= oneWeekAgo;
      });
      const prevWeekImpressions = prevWeekPosts.reduce((sum, p) => sum + (p.metrics?.impressions || 0), 0);
      
      return {
        total,
        impressions,
        likes,
        retweets,
        replies,
        engagements,
        avgER,
        weekPosts: weekPosts.length,
        weekImpressions,
        weekLikes,
        prevWeekImpressions,
        impressionChange: prevWeekImpressions > 0 ? ((weekImpressions - prevWeekImpressions) / prevWeekImpressions * 100) : 0
      };
    }

    // ===== ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° =====
    function renderMainStats(stats) {
      const container = document.getElementById('main-stats');
      container.innerHTML = `
        <div class="card stat-card">
          <div class="card-title">ç·æŠ•ç¨¿æ•°</div>
          <div class="value">${stats.total}</div>
          <div class="label">å…¨æœŸé–“</div>
          <div class="change neutral">ä»Šé€± ${stats.weekPosts} æŠ•ç¨¿</div>
        </div>
        <div class="card stat-card">
          <div class="card-title">ç·ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³</div>
          <div class="value">${formatNumber(stats.impressions)}</div>
          <div class="label">ç´¯è¨ˆ</div>
          <div class="change ${stats.impressionChange >= 0 ? 'up' : 'down'}">
            ${stats.impressionChange >= 0 ? 'â†‘' : 'â†“'} ${Math.abs(stats.impressionChange).toFixed(1)}% å‰é€±æ¯”
          </div>
        </div>
        <div class="card stat-card">
          <div class="card-title">ç·ã„ã„ã­</div>
          <div class="value">${stats.likes}</div>
          <div class="label">ç´¯è¨ˆ</div>
          <div class="change neutral">ä»Šé€± ${stats.weekLikes}</div>
        </div>
        <div class="card stat-card">
          <div class="card-title">å¹³å‡ER</div>
          <div class="value" style="color: ${stats.avgER >= 1 ? 'var(--accent-green)' : stats.avgER >= 0.5 ? 'var(--accent-orange)' : 'var(--accent-red)'}">${stats.avgER.toFixed(2)}%</div>
          <div class="label">ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡</div>
          <div class="change ${stats.avgER >= 1 ? 'up' : 'neutral'}">
            ç›®æ¨™: 1.0%ä»¥ä¸Š
          </div>
        </div>
      `;
    }
    
    function renderKPICards(stats) {
      const container = document.getElementById('kpi-cards');
      const kpis = [
        { label: 'é€±é–“ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³', current: stats.weekImpressions, target: 5000, unit: '' },
        { label: 'é€±é–“æŠ•ç¨¿æ•°', current: stats.weekPosts, target: 21, unit: 'æŠ•ç¨¿' },
        { label: 'ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡', current: stats.avgER, target: 1.0, unit: '%', isPercent: true },
      ];
      
      container.innerHTML = kpis.map(kpi => {
        const progress = Math.min((kpi.current / kpi.target) * 100, 100);
        const color = progress >= 80 ? 'var(--accent-green)' : progress >= 50 ? 'var(--accent-orange)' : 'var(--accent-red)';
        return `
          <div class="card">
            <div class="card-title">${kpi.label}</div>
            <div style="font-size: 28px; font-weight: 700; margin: 8px 0;">
              ${kpi.isPercent ? kpi.current.toFixed(2) : formatNumber(kpi.current)}${kpi.unit}
            </div>
            <div class="kpi-progress">
              <div class="kpi-bar">
                <div class="kpi-fill" style="width: ${progress}%; background: ${color};"></div>
              </div>
              <div class="kpi-labels">
                <span>é”æˆç‡: ${progress.toFixed(0)}%</span>
                <span>ç›®æ¨™: ${kpi.isPercent ? kpi.target.toFixed(1) : formatNumber(kpi.target)}${kpi.unit}</span>
              </div>
            </div>
          </div>
        `;
      }).join('');
    }
    
    function renderTopPosts(posts) {
      const container = document.getElementById('top-posts');
      const sorted = [...posts]
        .filter(p => p.metrics?.impressions > 0)
        .sort((a, b) => (b.metrics?.impressions || 0) - (a.metrics?.impressions || 0))
        .slice(0, 3);
      
      if (sorted.length === 0) {
        container.innerHTML = '<p style="color: var(--text-muted);">ã¾ã ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ã‚ã‚‹æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }
      
      container.innerHTML = sorted.map((post, i) => `
        <div class="post-card" style="border-left: 3px solid ${i === 0 ? 'var(--accent-orange)' : 'var(--border)'};">
          <div class="post-meta">
            <span>${formatDate(post.posted_at)}</span>
            <span class="post-type-badge ${getTypeClass(post.type)}">${getTypeLabel(post.type)}</span>
          </div>
          <div class="post-content">${post.content.substring(0, 200)}${post.content.length > 200 ? '...' : ''}</div>
          <div class="post-metrics">
            <span>ğŸ‘ï¸ ${formatNumber(post.metrics?.impressions || 0)}</span>
            <span>â¤ï¸ ${post.metrics?.likes || 0}</span>
            <span>ğŸ” ${post.metrics?.retweets || 0}</span>
            <span>ğŸ’¬ ${post.metrics?.replies || 0}</span>
            <span style="color: ${calculateER(post) >= 1 ? 'var(--accent-green)' : 'var(--text-muted)'};">ER: ${calculateER(post).toFixed(2)}%</span>
          </div>
        </div>
      `).join('');
    }
    
    function renderActionItems(stats) {
      const container = document.getElementById('action-items');
      const actions = [];
      
      if (stats.avgER < 0.5) {
        actions.push({ priority: 'high', title: 'ERæ”¹å–„ãŒå¿…è¦', desc: 'ãƒ•ãƒƒã‚¯å¼·åŒ–ãƒ»è³ªå•å½¢å¼ã®æŠ•ç¨¿ã‚’å¢—ã‚„ã™' });
      }
      if (stats.weekPosts < 14) {
        actions.push({ priority: 'medium', title: 'æŠ•ç¨¿é »åº¦ã‚’ä¸Šã’ã‚‹', desc: `ç¾åœ¨é€±${stats.weekPosts}æŠ•ç¨¿ â†’ ç›®æ¨™21æŠ•ç¨¿ï¼ˆ1æ—¥3å›ï¼‰` });
      }
      if (stats.weekImpressions < 1000) {
        actions.push({ priority: 'high', title: 'ã‚¤ãƒ³ãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³å‘ä¸Š', desc: 'ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æŠ•ç¨¿ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å‚è€ƒã«ã™ã‚‹' });
      }
      
      actions.push({ priority: 'low', title: 'ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼ã¸ã®ãƒªãƒ—ãƒ©ã‚¤', desc: 'é–¢é€£æŠ•ç¨¿ã«ç©æ¥µçš„ã«ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆ1æ—¥10ä»¶ç›®æ¨™ï¼‰' });
      actions.push({ priority: 'low', title: 'ã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿ã‚’è©¦ã™', desc: 'ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°è§£èª¬ã§ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆå‘ä¸Š' });
      
      container.innerHTML = actions.map(a => `
        <div class="action-item">
          <div class="action-priority priority-${a.priority}"></div>
          <div class="action-content">
            <div class="action-title">${a.title}</div>
            <div class="action-desc">${a.desc}</div>
          </div>
        </div>
      `).join('');
    }
    
    function renderAlerts(stats) {
      const container = document.getElementById('alerts-container');
      const alerts = [];
      
      // æœ€æ–°æŠ•ç¨¿æ—¥ã‚’ç¢ºèª
      if (postHistory.length > 0) {
        const latestPost = new Date(postHistory[0].posted_at);
        const hoursSinceLastPost = (Date.now() - latestPost) / (1000 * 60 * 60);
        
        if (hoursSinceLastPost > 24) {
          alerts.push({
            type: 'warning',
            icon: 'âš ï¸',
            title: 'æŠ•ç¨¿ãŒåœæ­¢ã—ã¦ã„ã¾ã™',
            message: `æœ€çµ‚æŠ•ç¨¿ã‹ã‚‰${Math.floor(hoursSinceLastPost)}æ™‚é–“çµŒéã€‚GitHub Actionsã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`
          });
        }
      }
      
      if (stats.avgER < 0.3) {
        alerts.push({
          type: 'error',
          icon: 'ğŸš¨',
          title: 'ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆç‡ãŒä½ä¸‹',
          message: `ç¾åœ¨ã®ER ${stats.avgER.toFixed(2)}%ã€‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æˆ¦ç•¥ã®è¦‹ç›´ã—ã‚’æ¨å¥¨ã€‚`
        });
      }
      
      container.innerHTML = alerts.map(a => `
        <div class="alert alert-${a.type}">
          <div class="alert-icon">${a.icon}</div>
          <div class="alert-content">
            <h4>${a.title}</h4>
            <p>${a.message}</p>
          </div>
        </div>
      `).join('');
    }
    
    function renderPostsList(posts, filter = 'all') {
      const container = document.getElementById('posts-list');
      const quickStats = document.getElementById('posts-quick-stats');
      
      let filtered = posts;
      if (filter !== 'all') {
        filtered = posts.filter(p => p.type === filter);
      }
      
      // ã‚¿ã‚¤ãƒ—åˆ¥ã‚«ã‚¦ãƒ³ãƒˆ
      const typeCounts = {};
      posts.forEach(p => {
        const t = p.type || 'unknown';
        typeCounts[t] = (typeCounts[t] || 0) + 1;
      });
      
      quickStats.innerHTML = Object.entries(typeCounts)
        .sort((a, b) => b[1] - a[1])
        .map(([type, count]) => `
          <div class="quick-stat">
            <span class="quick-stat-value">${count}</span>
            <span class="quick-stat-label">${getTypeLabel(type)}</span>
          </div>
        `).join('');
      
      container.innerHTML = filtered.slice(0, 20).map(post => `
        <div class="post-card">
          <div class="post-meta">
            <span>${formatDate(post.posted_at)}</span>
            <div>
              <span class="post-type-badge ${getTypeClass(post.type)}">${getTypeLabel(post.type)}</span>
              <span style="margin-left: 8px; color: var(--text-muted);">${post.slot || '-'}</span>
            </div>
          </div>
          <div class="post-content">${post.content}</div>
          <div class="post-metrics">
            <span>ğŸ‘ï¸ ${formatNumber(post.metrics?.impressions || 0)}</span>
            <span>â¤ï¸ ${post.metrics?.likes || 0}</span>
            <span>ğŸ” ${post.metrics?.retweets || 0}</span>
            <span>ğŸ’¬ ${post.metrics?.replies || 0}</span>
            <span style="color: ${calculateER(post) >= 1 ? 'var(--accent-green)' : 'var(--text-muted)'};">
              ER: ${calculateER(post).toFixed(2)}%
            </span>
          </div>
        </div>
      `).join('');
      
      if (filtered.length > 20) {
        container.innerHTML += `<p style="text-align: center; color: var(--text-muted); padding: 20px;">+ ${filtered.length - 20} ä»¶ã®æŠ•ç¨¿</p>`;
      }
    }

    function renderScheduledPosts(days = 7) {
      const container = document.getElementById('scheduled-posts-list');
      if (!container) return;

      if (!scheduledPosts || scheduledPosts.length === 0) {
        container.innerHTML = '<div class="card" style="text-align: center; color: var(--text-muted); padding: 30px;">æŠ•ç¨¿äºˆå®šãŒã‚ã‚Šã¾ã›ã‚“</div>';
        return;
      }

      // ä»Šæ—¥ã‹ã‚‰æŒ‡å®šæ—¥æ•°å¾Œã¾ã§ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ¸ˆã¿æŠ•ç¨¿ã‚’å–å¾—
      const today = new Date().toISOString().split('T')[0];
      const endDate = new Date(Date.now() + days * 24 * 60 * 60 * 1000).toISOString().split('T')[0];

      // æŠ•ç¨¿æ¸ˆã¿IDã‚’å–å¾—
      const postedIds = new Set(postHistory.map(h => h.post_id));

      const upcoming = scheduledPosts
        .filter(p => p.scheduled_date >= today && p.scheduled_date <= endDate && !postedIds.has(p.id))
        .sort((a, b) => a.scheduled_date.localeCompare(b.scheduled_date) || (a.slot === 'morning' ? -1 : 1));

      if (upcoming.length === 0) {
        container.innerHTML = '<div class="card" style="text-align: center; color: var(--text-muted); padding: 30px;">ã“ã®æœŸé–“ã®æŠ•ç¨¿äºˆå®šã¯ã‚ã‚Šã¾ã›ã‚“</div>';
        return;
      }

      // æ—¥ä»˜ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
      const byDate = {};
      upcoming.forEach(p => {
        if (!byDate[p.scheduled_date]) byDate[p.scheduled_date] = [];
        byDate[p.scheduled_date].push(p);
      });

      const slotLabel = { morning: 'ğŸŒ… 08:00', mid_morning: 'â˜€ï¸ 10:00', noon: 'ğŸŒ 12:00', evening: 'ğŸŒ† 17:00', night: 'ğŸŒ™ 21:00' };
      const themeColors = {};
      const colorPalette = ['#58a6ff', '#3fb950', '#d29922', '#f778ba', '#bc8cff', '#79c0ff', '#56d364'];
      let colorIdx = 0;
      function getThemeColor(theme) {
        if (!themeColors[theme]) { themeColors[theme] = colorPalette[colorIdx % colorPalette.length]; colorIdx++; }
        return themeColors[theme];
      }

      const isToday = (d) => d === today;

      container.innerHTML = Object.entries(byDate).map(([date, posts]) => {
        const dayLabel = isToday(date) ? 'ä»Šæ—¥' : new Date(date + 'T00:00:00').toLocaleDateString('ja-JP', { month: 'short', day: 'numeric', weekday: 'short' });
        return `
          <div style="margin-bottom: 16px;">
            <div style="font-size: 13px; font-weight: 600; color: ${isToday(date) ? 'var(--accent-orange)' : 'var(--text-secondary)'}; margin-bottom: 8px; padding-left: 4px;">
              ${isToday(date) ? 'ğŸ”´ ' : ''}${dayLabel} (${date})
            </div>
            ${posts.map(p => `
              <div class="post-card" style="border-left: 3px solid ${getThemeColor(p.theme)}; margin-bottom: 8px;">
                <div class="post-meta">
                  <span>${slotLabel[p.slot] || p.slot}</span>
                  <span style="font-size: 12px; padding: 2px 8px; background: ${getThemeColor(p.theme)}22; color: ${getThemeColor(p.theme)}; border-radius: 4px;">${p.theme}</span>
                </div>
                <div class="post-content" style="font-size: 13px; color: var(--text-secondary);">${(p.variant_a || '').substring(0, 120)}${(p.variant_a || '').length > 120 ? '...' : ''}</div>
              </div>
            `).join('')}
          </div>
        `;
      }).join('');
    }

    function renderTypePerformance(posts) {
      const container = document.getElementById('type-performance');
      const typeStats = {};
      
      posts.forEach(p => {
        const type = p.type || 'unknown';
        if (!typeStats[type]) {
          typeStats[type] = { count: 0, impressions: 0, likes: 0 };
        }
        typeStats[type].count++;
        typeStats[type].impressions += p.metrics?.impressions || 0;
        typeStats[type].likes += p.metrics?.likes || 0;
      });
      
      const sorted = Object.entries(typeStats)
        .map(([type, stats]) => ({
          type,
          ...stats,
          avgImp: stats.count > 0 ? stats.impressions / stats.count : 0,
          avgER: stats.impressions > 0 ? (stats.likes / stats.impressions * 100) : 0
        }))
        .sort((a, b) => b.avgImp - a.avgImp);
      
      const maxImp = Math.max(...sorted.map(s => s.avgImp), 1);
      
      container.innerHTML = `
        <div class="bar-chart">
          ${sorted.map(s => `
            <div class="bar-item">
              <div class="bar-value">${s.avgImp.toFixed(0)}</div>
              <div class="bar" style="height: ${(s.avgImp / maxImp) * 100}%; background: var(--accent-blue);"></div>
              <div class="bar-label">${getTypeLabel(s.type)}<br><span style="color: var(--text-muted);">(${s.count}ä»¶)</span></div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    function renderTimePerformance(posts) {
      const container = document.getElementById('time-performance');
      const slotStats = { morning: { count: 0, imp: 0 }, noon: { count: 0, imp: 0 }, night: { count: 0, imp: 0 } };
      
      posts.forEach(p => {
        const slot = p.slot || 'noon';
        if (slotStats[slot]) {
          slotStats[slot].count++;
          slotStats[slot].imp += p.metrics?.impressions || 0;
        }
      });
      
      const slots = [
        { key: 'morning', label: 'æœ (9:00)', ...slotStats.morning },
        { key: 'noon', label: 'æ˜¼ (12:00)', ...slotStats.noon },
        { key: 'night', label: 'å¤œ (20:00)', ...slotStats.night },
      ].map(s => ({ ...s, avg: s.count > 0 ? s.imp / s.count : 0 }));
      
      const maxAvg = Math.max(...slots.map(s => s.avg), 1);
      
      container.innerHTML = `
        <div class="bar-chart">
          ${slots.map(s => `
            <div class="bar-item">
              <div class="bar-value">${s.avg.toFixed(0)}</div>
              <div class="bar" style="height: ${(s.avg / maxAvg) * 100}%; background: var(--accent-purple);"></div>
              <div class="bar-label">${s.label}<br><span style="color: var(--text-muted);">(${s.count}ä»¶)</span></div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    function renderWeeklyTrend(posts) {
      const container = document.getElementById('weekly-trend');
      const weeks = {};
      
      posts.forEach(p => {
        const d = new Date(p.posted_at);
        const weekStart = new Date(d);
        weekStart.setDate(d.getDate() - d.getDay());
        const key = weekStart.toISOString().split('T')[0];
        
        if (!weeks[key]) weeks[key] = { posts: 0, imp: 0, likes: 0 };
        weeks[key].posts++;
        weeks[key].imp += p.metrics?.impressions || 0;
        weeks[key].likes += p.metrics?.likes || 0;
      });
      
      const sortedWeeks = Object.entries(weeks)
        .sort((a, b) => b[0].localeCompare(a[0]))
        .slice(0, 8)
        .reverse();
      
      const maxImp = Math.max(...sortedWeeks.map(w => w[1].imp), 1);
      
      container.innerHTML = `
        <div class="bar-chart" style="height: 180px;">
          ${sortedWeeks.map(([week, data]) => {
            const d = new Date(week);
            const label = `${d.getMonth()+1}/${d.getDate()}é€±`;
            return `
              <div class="bar-item">
                <div class="bar-value">${formatNumber(data.imp)}</div>
                <div class="bar" style="height: ${(data.imp / maxImp) * 100}%; background: linear-gradient(to top, var(--accent-blue), var(--accent-cyan));"></div>
                <div class="bar-label">${label}<br><span style="color: var(--text-muted);">${data.posts}æŠ•ç¨¿</span></div>
              </div>
            `;
          }).join('')}
        </div>
      `;
    }
    
    function renderWinningElements(posts) {
      const container = document.getElementById('winning-elements');
      const topPosts = [...posts]
        .filter(p => p.metrics?.impressions >= 50)
        .sort((a, b) => calculateER(b) - calculateER(a))
        .slice(0, 5);
      
      if (topPosts.length === 0) {
        container.innerHTML = '<p style="color: var(--text-muted);">åˆ†æã«ååˆ†ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        return;
      }
      
      // å…±é€šè¦ç´ ã‚’æŠ½å‡º
      const elements = [];
      topPosts.forEach(p => {
        if (p.content.includes('ğŸ’¡') || p.content.includes('ğŸ”¥')) elements.push('çµµæ–‡å­—ä½¿ç”¨');
        if (p.content.match(/\n\n/)) elements.push('æ®µè½åˆ†ã‘');
        if (p.content.match(/#\w+/)) elements.push('ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°');
        if (p.content.match(/[ï¼Ÿ?]/)) elements.push('è³ªå•å½¢å¼');
        if (p.content.length < 140) elements.push('ç°¡æ½”ã•');
      });
      
      const counts = {};
      elements.forEach(e => counts[e] = (counts[e] || 0) + 1);
      
      container.innerHTML = Object.entries(counts)
        .sort((a, b) => b[1] - a[1])
        .map(([elem, count]) => `
          <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border);">
            <span>${elem}</span>
            <span style="color: var(--accent-green);">${count}ä»¶ã§ä½¿ç”¨</span>
          </div>
        `).join('');
    }
    
    function renderImprovementPoints(posts) {
      const container = document.getElementById('improvement-points');
      const points = [
        { issue: 'ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ä¸è¶³', solution: 'å‹•ç”»ãƒ»ã‚¹ã‚¯ã‚·ãƒ§ã®è¿½åŠ ã‚’æ¤œè¨' },
        { issue: 'æŠ•ç¨¿é »åº¦', solution: '1æ—¥3æŠ•ç¨¿ã‚’ç¶­æŒ' },
        { issue: 'ãƒ•ãƒƒã‚¯å¼±ã„', solution: 'ã€Œæ­£ç›´ã€ã€Œæ–­è¨€ã—ã¾ã™ã€ãªã©å¼·ã„è¨€è‘‰ã‚’ä½¿ã†' },
        { issue: 'ãƒªãƒ—ãƒ©ã‚¤ä¸è¶³', solution: 'ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼ã¸ã®ç©æ¥µçš„ãªã‚³ãƒ¡ãƒ³ãƒˆ' },
      ];
      
      container.innerHTML = points.map(p => `
        <div style="padding: 12px 0; border-bottom: 1px solid var(--border);">
          <div style="font-weight: 500; margin-bottom: 4px;">âš ï¸ ${p.issue}</div>
          <div style="font-size: 13px; color: var(--text-secondary);">â†’ ${p.solution}</div>
        </div>
      `).join('');
    }
    
    function renderOverseasInsights() {
      const container = document.getElementById('overseas-insights-list');
      const countEl = document.getElementById('overseas-insights-count');
      const updatedEl = document.getElementById('overseas-last-updated');
      
      if (!overseasInsights || !overseasInsights.ideas || overseasInsights.ideas.length === 0) {
        countEl.textContent = '-';
        return;
      }
      
      countEl.textContent = overseasInsights.ideas.length;
      
      // æœ€çµ‚æ›´æ–°æ—¥æ™‚
      const updatedAt = new Date(overseasInsights.researched_at);
      const hoursAgo = Math.round((Date.now() - updatedAt) / (1000 * 60 * 60));
      updatedEl.textContent = hoursAgo < 24 ? `${hoursAgo}æ™‚é–“å‰` : `${Math.round(hoursAgo/24)}æ—¥å‰`;
      
      container.innerHTML = `
        <div style="margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border);">
          <span style="color: var(--text-secondary); font-size: 13px;">
            ğŸ” ãƒªã‚µãƒ¼ãƒæ–¹æ³•: <strong>Grok</strong> | 
            ğŸ“… ${updatedAt.toLocaleString('ja-JP')} | 
            ğŸ¯ ${overseasInsights.topics_found || 0}ä»¶ã®ãƒˆãƒ”ãƒƒã‚¯ç™ºè¦‹
          </span>
        </div>
        ${overseasInsights.ideas.map(idea => {
          const noveltyColor = idea.insight.novelty_score >= 8 ? 'var(--accent-green)' : 
                               idea.insight.novelty_score >= 6 ? 'var(--accent-orange)' : 'var(--text-muted)';
          const noveltyEmoji = idea.insight.novelty_score >= 8 ? 'ğŸŒŸ' : idea.insight.novelty_score >= 6 ? 'âœ…' : 'ğŸ“';
          return `
            <div style="padding: 12px 0; border-bottom: 1px solid var(--border);">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <span style="font-weight: 600; color: var(--accent-cyan);">${idea.insight.topic}</span>
                <span style="color: ${noveltyColor}; font-size: 13px;">
                  ${noveltyEmoji} æ–°è¦æ€§: ${idea.insight.novelty_score}/10
                </span>
              </div>
              <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 8px;">
                ${idea.insight.summary}
              </p>
              <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                <span style="color: var(--text-muted); font-size: 12px;">ğŸ“ æ—¥æœ¬èªã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ¡ˆ:</span>
                <p style="color: var(--text-primary); margin-top: 4px; font-size: 14px;">
                  ${idea.japanese_adaptation}
                </p>
              </div>
              <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                ${idea.insight.key_accounts.map(acc => `
                  <a href="https://x.com/${acc.replace('@', '')}" target="_blank" 
                     style="color: var(--accent-blue); font-size: 12px; text-decoration: none;">
                    ${acc}
                  </a>
                `).join('')}
              </div>
            </div>
          `;
        }).join('')}
      `;
    }
    
    function renderReplySuggestions() {
      const container = document.getElementById('reply-suggestions');
      
      if (!replySuggestions || !replySuggestions.suggestions || replySuggestions.suggestions.length === 0) {
        container.innerHTML = `
          <p style="color: var(--text-muted);">
            ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚<br>
            <code style="font-size: 12px;">npm run suggest-replies</code> ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
          </p>
        `;
        return;
      }
      
      const pending = replySuggestions.suggestions.filter(s => !s.executed);
      const executed = replySuggestions.suggestions.filter(s => s.executed);
      
      container.innerHTML = `
        <div style="margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
          <span style="color: var(--text-secondary); font-size: 13px;">
            ğŸ“… ç”Ÿæˆ: ${new Date(replySuggestions.generated_at).toLocaleString('ja-JP')} |
            æœªå®Ÿè¡Œ: ${pending.length}ä»¶ | å®Ÿè¡Œæ¸ˆã¿: ${executed.length}ä»¶
          </span>
        </div>
        ${pending.length === 0 ? '<p style="color: var(--text-muted);">å…¨ã¦å®Ÿè¡Œæ¸ˆã¿ã§ã™ âœ…</p>' : ''}
        ${pending.map((s, i) => {
          const scoreEmoji = s.quality_score >= 8 ? 'ğŸŒŸ' : s.quality_score >= 6 ? 'âœ…' : 'ğŸ“';
          const relevanceColor = s.relevance === 'high' ? 'var(--accent-green)' : 
                                 s.relevance === 'medium' ? 'var(--accent-orange)' : 'var(--text-muted)';
          return `
            <div style="padding: 12px; margin-bottom: 8px; background: var(--bg-secondary); border-radius: 8px; border-left: 3px solid ${relevanceColor};">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <a href="${s.tweet.url}" target="_blank" style="color: var(--accent-blue); text-decoration: none; font-weight: 600;">
                  @${s.tweet.author}
                </a>
                <span style="font-size: 12px; color: var(--text-muted);">
                  ${scoreEmoji} ã‚¹ã‚³ã‚¢: ${s.quality_score}/10
                </span>
              </div>
              <div style="color: var(--text-secondary); font-size: 13px; margin-bottom: 8px; padding: 8px; background: var(--bg-card); border-radius: 4px;">
                "${s.tweet.text.substring(0, 80)}${s.tweet.text.length > 80 ? '...' : ''}"
              </div>
              <div style="background: var(--bg-card); padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                <span style="color: var(--accent-cyan); font-size: 12px;">ğŸ’¬ ææ¡ˆãƒªãƒ—ãƒ©ã‚¤:</span>
                <p style="color: var(--text-primary); margin-top: 4px; font-size: 14px;">${s.suggested_reply}</p>
              </div>
              <div style="display: flex; gap: 8px; justify-content: flex-end;">
                <a href="${s.tweet.url}" target="_blank" 
                   style="padding: 6px 12px; background: var(--accent-blue); color: white; border-radius: 6px; text-decoration: none; font-size: 12px;">
                  ğŸ”— å…ƒãƒ„ã‚¤ãƒ¼ãƒˆ
                </a>
                <button onclick="copyReply('${encodeURIComponent(s.suggested_reply)}')"
                   style="padding: 6px 12px; background: var(--accent-green); color: white; border-radius: 6px; border: none; cursor: pointer; font-size: 12px;">
                  ğŸ“‹ ã‚³ãƒ”ãƒ¼
                </button>
              </div>
            </div>
          `;
        }).join('')}
        <div style="margin-top: 12px; padding: 10px; background: var(--bg-secondary); border-radius: 6px;">
          <span style="color: var(--text-muted); font-size: 12px;">
            ğŸ’¡ ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰å®Ÿè¡Œ: <code>npm run reply 0</code> (ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0ã‚’å®Ÿè¡Œ) ã¾ãŸã¯ <code>npm run reply all</code> (å…¨ã¦å®Ÿè¡Œ)
          </span>
        </div>
      `;
    }
    
    function copyReply(encodedText) {
      const text = decodeURIComponent(encodedText);
      navigator.clipboard.writeText(text).then(() => {
        alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
      });
    }
    
    // renderInfluencers ã¯ç›£è¦–ã‚¿ãƒ–ã«çµ±åˆæ¸ˆã¿ï¼ˆrenderInfluencerTags ã§è¡¨ç¤ºï¼‰
    
    function renderSchedule() {
      const container = document.getElementById('schedule-grid');
      container.style.gridTemplateColumns = 'repeat(5, 1fr)';
      const now = new Date();
      const currentHour = now.getHours();
      
      const slots = [
        { time: '08:00', type: 'Tipså‹', icon: 'ğŸ’¡', hour: 8 },
        { time: '10:00', type: 'ç™ºè¦‹å‹', icon: 'ğŸ”', hour: 10 },
        { time: '12:00', type: 'ãƒã‚ºç‹™ã„', icon: 'ğŸ”¥', hour: 12 },
        { time: '18:00', type: 'å•é¡Œæèµ·', icon: 'â“', hour: 18 },
        { time: '21:00', type: 'ç‰©èªå‹', icon: 'ğŸ“–', hour: 21 },
      ];
      
      container.innerHTML = slots.map(slot => {
        const isCompleted = currentHour > slot.hour;
        const isNext = !isCompleted && currentHour < slot.hour;
        return `
          <div class="schedule-slot ${isCompleted ? 'completed' : ''} ${isNext && slots.filter(s => !isCompleted && currentHour < s.hour)[0] === slot ? 'next' : ''}">
            <div style="font-size: 24px; margin-bottom: 8px;">${slot.icon}</div>
            <div class="schedule-time">${slot.time}</div>
            <div class="schedule-type">${slot.type}</div>
            <div class="schedule-status" style="background: ${isCompleted ? 'var(--success)' : isNext ? 'var(--accent-blue)' : 'var(--bg-card)'};">
              ${isCompleted ? 'âœ“ å®Œäº†' : isNext ? 'â†’ æ¬¡å›' : 'äºˆå®š'}
            </div>
          </div>
        `;
      }).join('');
    }
    
    async function renderActivityLog() {
      const container = document.getElementById('activity-log');
      
      // æŠ•ç¨¿å±¥æ­´ã‹ã‚‰ãƒ­ã‚°ã‚’ç”Ÿæˆ
      const logs = postHistory.slice(0, 15).map(p => ({
        time: new Date(p.posted_at),
        type: 'post',
        message: `æŠ•ç¨¿å®Œäº†: ${p.content.substring(0, 50)}...`
      }));
      
      // ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†ãƒ­ã‚°ã‚’è¿½åŠ 
      const hasMetrics = postHistory.some(p => p.metrics?.collected_at);
      if (hasMetrics) {
        const latest = postHistory.find(p => p.metrics?.collected_at);
        if (latest) {
          logs.push({
            time: new Date(latest.metrics.collected_at),
            type: 'metrics',
            message: `ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†å®Œäº†: ${postHistory.length}ä»¶`
          });
        }
      }
      
      // GitHub Actions ãƒ­ã‚°ã‚’èª­ã¿è¾¼ã¿
      try {
        const logsUrl = isProduction 
          ? 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/logs.json?t=' + Date.now()
          : './logs.json';
        const res = await fetch(logsUrl);
        if (res.ok) {
          const actionLogs = await res.json();
          if (actionLogs.last_run) {
            logs.push({
              time: new Date(actionLogs.last_run),
              type: 'action',
              message: `GitHub Actions: ${actionLogs.job} - ${actionLogs.status}`
            });
            
            // å„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ­ã‚°ã‚‚è¿½åŠ 
            if (actionLogs.actions) {
              Object.entries(actionLogs.actions).forEach(([key, value]) => {
                if (value === true) {
                  logs.push({
                    time: new Date(actionLogs.last_run),
                    type: 'action_detail',
                    message: `  â”” ${key.replace(/_/g, ' ')}: âœ“`
                  });
                }
              });
            }
          }
        }
      } catch (e) {
        console.log('Failed to load action logs:', e);
      }
      
      logs.sort((a, b) => b.time - a.time);
      
      if (logs.length === 0) {
        container.innerHTML = '<div style="padding: 20px; color: var(--text-muted); text-align: center;">ãƒ­ã‚°ãŒã‚ã‚Šã¾ã›ã‚“</div>';
        return;
      }
      
      container.innerHTML = logs.slice(0, 30).map(log => `
        <div class="log-entry">
          <span class="log-time">${log.time.toLocaleString('ja-JP')}</span>
          <span class="log-icon">${
            log.type === 'post' ? 'ğŸ“¤' : 
            log.type === 'metrics' ? 'ğŸ“Š' : 
            log.type === 'action' ? 'âš™ï¸' :
            log.type === 'action_detail' ? '  ' : 'ğŸ”§'
          }</span>
          <span class="log-message">${log.message}</span>
        </div>
      `).join('');
    }
    
    function renderSystemInfo() {
      document.getElementById('system-config').innerHTML = `
        <div style="font-size: 13px; line-height: 2;">
          <div>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ: <strong>@ai_risukirin</strong></div>
          <div>æŠ•ç¨¿é »åº¦: <strong>1æ—¥3å›</strong></div>
          <div>LLM: <strong>GPT-4o + Gemini</strong></div>
          <div>Grok: <span style="color: var(--text-muted);">ã‚ªãƒ—ã‚·ãƒ§ãƒ³</span></div>
        </div>
      `;
      
      document.getElementById('api-status').innerHTML = `
        <div style="font-size: 13px; line-height: 2;">
          <div>X API: <span style="color: var(--accent-green);">âœ“ è¨­å®šæ¸ˆã¿</span></div>
          <div>OpenAI: <span style="color: var(--accent-green);">âœ“ è¨­å®šæ¸ˆã¿</span></div>
          <div>Google AI: <span style="color: var(--accent-green);">âœ“ è¨­å®šæ¸ˆã¿</span></div>
          <div>Grok: <span style="color: var(--text-muted);">æœªè¨­å®š</span></div>
        </div>
      `;
    }

    // ===== ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ =====
    // ç’°å¢ƒã«å¿œã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’é¸æŠ
    const isProduction = location.hostname !== 'localhost' && location.hostname !== '127.0.0.1';
    
    const DATA_SOURCES = {
      // Vercel/æœ¬ç•ªç’°å¢ƒç”¨: GitHub raw URLï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥å›é¿ã®ãŸã‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜åŠ ï¼‰
      github: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/data.json',
      github_overseas: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/overseas.json',
      github_account: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/account.json',
      github_replies: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/replies.json',
      github_pool: 'https://raw.githubusercontent.com/watchout/x-marketing-engine/main/dashboard/pool.json',
      // ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨
      local: './data.json',
      local_overseas: './overseas.json',
      local_account: './account.json',
      local_pool: './pool.json'
    };
    
    let overseasInsights = null;
    let accountStats = null;
    let replySuggestions = null;
    
    async function loadData() {
      // æœ¬ç•ªç’°å¢ƒã§ã¯GitHubã‹ã‚‰ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰
      const sources = isProduction 
        ? [DATA_SOURCES.github + '?t=' + Date.now(), DATA_SOURCES.local]
        : [DATA_SOURCES.local, DATA_SOURCES.github];
      
      console.log('Environment:', isProduction ? 'Production' : 'Local');
      
      for (const url of sources) {
        try {
          console.log('Trying to load from:', url);
          const res = await fetch(url);
          if (res.ok) {
            postHistory = await res.json();
            systemStatus = 'active';
            console.log('âœ… Data loaded successfully from:', url.split('?')[0]);
            console.log('ğŸ“Š Posts count:', postHistory.length);
            break;
          } else {
            console.log('âŒ Failed with status:', res.status);
          }
        } catch (e) {
          console.log('âŒ Error loading from:', url, e.message);
        }
      }
      
      if (postHistory.length === 0) {
        console.error('Failed to load data from all sources');
        systemStatus = 'error';
      }
      
      // æµ·å¤–ã‚¤ãƒ³ã‚µã‚¤ãƒˆã‚’èª­ã¿è¾¼ã¿
      const overseasSources = isProduction 
        ? [DATA_SOURCES.github_overseas + '?t=' + Date.now(), DATA_SOURCES.local_overseas]
        : [DATA_SOURCES.local_overseas, DATA_SOURCES.github_overseas];
      
      for (const url of overseasSources) {
        try {
          const res = await fetch(url);
          if (res.ok) {
            overseasInsights = await res.json();
            console.log('âœ… Overseas insights loaded:', overseasInsights?.ideas?.length || 0, 'ideas');
            break;
          }
        } catch (e) {
          // æµ·å¤–ã‚¤ãƒ³ã‚µã‚¤ãƒˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
        }
      }
      
      // æŠ•ç¨¿ãƒ—ãƒ¼ãƒ«ï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ¸ˆã¿æŠ•ç¨¿ï¼‰ã‚’èª­ã¿è¾¼ã¿
      const poolSources = isProduction
        ? [DATA_SOURCES.github_pool + '?t=' + Date.now(), DATA_SOURCES.local_pool]
        : [DATA_SOURCES.local_pool, DATA_SOURCES.github_pool];

      for (const url of poolSources) {
        try {
          const res = await fetch(url);
          if (res.ok) {
            scheduledPosts = await res.json();
            console.log('âœ… Pool loaded:', scheduledPosts.length, 'scheduled posts');
            break;
          }
        } catch (e) {
          // ãƒ—ãƒ¼ãƒ«ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
        }
      }

      // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçµ±è¨ˆã‚’èª­ã¿è¾¼ã¿
      const accountSources = isProduction 
        ? [DATA_SOURCES.github_account + '?t=' + Date.now(), DATA_SOURCES.local_account]
        : [DATA_SOURCES.local_account, DATA_SOURCES.github_account];
      
      for (const url of accountSources) {
        try {
          const res = await fetch(url);
          if (res.ok) {
            accountStats = await res.json();
            console.log('âœ… Account stats loaded:', accountStats?.followers_count, 'followers');
            break;
          }
        } catch (e) {
          // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçµ±è¨ˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
        }
      }
      
      // ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆã‚’èª­ã¿è¾¼ã¿
      try {
        const replyUrl = isProduction 
          ? DATA_SOURCES.github_replies + '?t=' + Date.now()
          : './replies.json';
        const res = await fetch(replyUrl);
        if (res.ok) {
          replySuggestions = await res.json();
          console.log('âœ… Reply suggestions loaded:', replySuggestions?.suggestions?.length || 0);
        }
      } catch (e) {
        // ãƒªãƒ—ãƒ©ã‚¤ææ¡ˆã¯ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«
      }
      
      // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
      const statusEl = document.getElementById('system-status');
      if (postHistory.length > 0) {
        const latestPost = new Date(postHistory[0].posted_at);
        const hoursSince = (Date.now() - latestPost) / (1000 * 60 * 60);
        
        if (hoursSince > 48) {
          statusEl.className = 'status-badge status-error';
          statusEl.textContent = 'æŠ•ç¨¿åœæ­¢ä¸­';
        } else if (hoursSince > 24) {
          statusEl.className = 'status-badge status-warning';
          statusEl.textContent = 'è¦ç¢ºèª';
        } else {
          statusEl.className = 'status-badge status-active';
          statusEl.textContent = 'ç¨¼åƒä¸­';
        }
      } else {
        statusEl.className = 'status-badge status-warning';
        statusEl.textContent = 'ãƒ‡ãƒ¼ã‚¿ãªã—';
      }
      
      document.getElementById('last-updated').textContent = `æ›´æ–°: ${new Date().toLocaleString('ja-JP')}`;
      
      // ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°ã‚’è¡¨ç¤º
      if (accountStats && accountStats.followers_count !== undefined) {
        document.getElementById('follower-number').textContent = accountStats.followers_count.toLocaleString();
      }
    }
    
    function render() {
      const stats = calculateStats(postHistory);
      
      renderMainStats(stats);
      renderKPICards(stats);
      renderTopPosts(postHistory);
      renderActionItems(stats);
      renderAlerts(stats);
      renderScheduledPosts();
      renderPostsList(postHistory);
      renderTypePerformance(postHistory);
      renderTimePerformance(postHistory);
      renderWeeklyTrend(postHistory);
      renderWinningElements(postHistory);
      renderImprovementPoints(postHistory);
      renderOverseasInsights();
      renderReplySuggestions();
      renderSchedule();
      renderActivityLog();
      renderSystemInfo();
    }

    // ===== ã‚¤ãƒ™ãƒ³ãƒˆ =====
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        tab.classList.add('active');
        document.getElementById('tab-' + tab.dataset.tab).classList.add('active');
      });
    });
    
    document.getElementById('posts-filter').addEventListener('change', (e) => {
      renderPostsList(postHistory, e.target.value);
    });

    document.getElementById('schedule-range').addEventListener('change', (e) => {
      renderScheduledPosts(parseInt(e.target.value));
    });

    // ===== åˆæœŸåŒ– =====
    loadData().then(() => {
      render();
      document.getElementById('loading').style.display = 'none';
      document.getElementById('main-content').style.display = 'block';
    });
    
    // è‡ªå‹•æ›´æ–° (5åˆ†ã”ã¨)
    setInterval(() => {
      loadData().then(render);
    }, 300000);

    // ===== ãƒªã‚µãƒ¼ãƒãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ©Ÿèƒ½ =====

    const WATCH_STORAGE_KEY = 'xme_influencer_watch';
    let selectedAccount = null;

    const DEFAULT_GENRES = {
      ai_dev:       { label: 'AIé–‹ç™ºãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ', icon: 'ğŸ› ï¸' },
      ai_tools:     { label: 'AIãƒ„ãƒ¼ãƒ«æ´»ç”¨', icon: 'âš¡' },
      ai_news:      { label: 'AIãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ»é€Ÿå ±', icon: 'ğŸ“°' },
      ai_marketing: { label: 'AIÃ—ãƒãƒ¼ã‚±ãƒ»ç™ºä¿¡è¡“', icon: 'ğŸ“£' },
      overseas:     { label: 'æµ·å¤–AIå‹•å‘', icon: 'ğŸŒ' },
      other:        { label: 'ãã®ä»–', icon: 'ğŸ“Œ' }
    };

    // --- ãƒ‡ãƒ¼ã‚¿ç®¡ç† ---
    function getWatchData() {
      try {
        const raw = localStorage.getItem(WATCH_STORAGE_KEY);
        if (raw) {
          const d = JSON.parse(raw);
          if (!d.genres) d.genres = DEFAULT_GENRES;
          return d;
        }
      } catch(e) {}
      return { influencers: [], posts: [], genres: DEFAULT_GENRES, last_exported: null };
    }

    function saveWatchData(data) {
      data.updated_at = new Date().toISOString();
      localStorage.setItem(WATCH_STORAGE_KEY, JSON.stringify(data));
    }

    function updateStats() {
      const data = getWatchData();
      document.getElementById('watch-total-influencers').textContent = data.influencers.length;
      document.getElementById('watch-total-posts').textContent = data.posts.length;
      document.getElementById('watch-analyzed').textContent = data.posts.filter(p => p.analysis).length;
    }

    // --- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  ---
    function toggleAddForm() {
      const form = document.getElementById('add-influencer-form');
      const isHidden = form.style.display === 'none';
      form.style.display = isHidden ? 'block' : 'none';
      if (isHidden) {
        // ã‚¸ãƒ£ãƒ³ãƒ«select ã‚’ç”Ÿæˆ
        const data = getWatchData();
        const genres = data.genres || DEFAULT_GENRES;
        const sel = document.getElementById('new-influencer-genre');
        sel.innerHTML = Object.entries(genres).map(([k,v]) =>
          `<option value="${k}">${v.icon} ${v.label}</option>`
        ).join('');
      }
    }

    function addInfluencer() {
      const handleInput = document.getElementById('new-influencer-handle');
      const categoryInput = document.getElementById('new-influencer-category');
      const genreSelect = document.getElementById('new-influencer-genre');
      let handle = handleInput.value.trim().replace(/^@/, '');
      const category = categoryInput.value.trim() || '';
      const genre = genreSelect.value || 'other';

      if (!handle) { alert('ãƒãƒ³ãƒ‰ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }

      const data = getWatchData();
      if (data.influencers.find(i => i.handle === handle)) {
        alert(`@${handle} ã¯æ—¢ã«ç™»éŒ²æ¸ˆã¿ã§ã™`); return;
      }

      data.influencers.push({ handle, category, genre, added_at: new Date().toISOString() });
      saveWatchData(data);

      handleInput.value = '';
      categoryInput.value = '';
      document.getElementById('add-influencer-form').style.display = 'none';
      renderGenreGrid();
      updateFilterSelect();
    }

    function removeInfluencer(handle, e) {
      e.stopPropagation();
      if (!confirm(`@${handle} ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) return;
      const data = getWatchData();
      data.influencers = data.influencers.filter(i => i.handle !== handle);
      saveWatchData(data);
      if (selectedAccount === handle) clearSelectedAccount();
      renderGenreGrid();
      updateFilterSelect();
    }

    // --- ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ãƒœã‚¿ãƒ³ã‚°ãƒªãƒƒãƒ‰ ---
    function renderGenreGrid() {
      const container = document.getElementById('genre-account-grid');
      const data = getWatchData();
      const genres = data.genres || DEFAULT_GENRES;

      // æŠ•ç¨¿æ•°é›†è¨ˆ
      const postCounts = {};
      data.posts.forEach(p => { postCounts[p.handle] = (postCounts[p.handle] || 0) + 1; });

      // ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥ã«ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
      const grouped = {};
      for (const g of Object.keys(genres)) grouped[g] = [];
      data.influencers.forEach(inf => {
        const g = inf.genre || 'other';
        if (!grouped[g]) grouped[g] = [];
        grouped[g].push(inf);
      });

      let html = '';
      for (const [genreKey, genreInfo] of Object.entries(genres)) {
        const accounts = grouped[genreKey] || [];
        if (accounts.length === 0) continue;

        html += `
          <div style="margin-bottom: 16px;">
            <div style="font-size: 13px; color: var(--text-muted); margin-bottom: 6px; font-weight: 600;">
              ${genreInfo.icon} ${genreInfo.label}
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: 6px;">
              ${accounts.map(acc => `
                <button class="account-btn ${selectedAccount === acc.handle ? 'active' : ''}"
                        onclick="selectAccount('${acc.handle}')"
                        title="${acc.category || acc.handle}">
                  <span class="account-btn-name">@${acc.handle}</span>
                  <span class="account-btn-count">${postCounts[acc.handle] || 0}</span>
                  <span class="account-btn-remove" onclick="removeInfluencer('${acc.handle}', event)">&times;</span>
                </button>
              `).join('')}
            </div>
          </div>
        `;
      }

      if (html === '') {
        html = '<div class="card" style="text-align:center; color: var(--text-muted); padding: 24px;">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã€Œï¼‹ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¿½åŠ ã€ã‹ã‚‰è¿½åŠ ã—ã¦ãã ã•ã„ã€‚</div>';
      }

      container.innerHTML = html;
      updateStats();
    }

    // --- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠ â†’ Xæ–°è¦ã‚¿ãƒ– + å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã«ã‚»ãƒƒãƒˆ ---
    function selectAccount(handle) {
      selectedAccount = handle;

      // X ã‚’æ–°è¦ã‚¿ãƒ–ã§é–‹ã
      window.open(`https://x.com/${handle}`, '_blank');

      // ãƒãƒŠãƒ¼è¡¨ç¤º
      document.getElementById('selected-account-banner').style.display = 'flex';
      document.getElementById('selected-account-name').textContent = `@${handle}`;

      // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹æ›´æ–°
      renderGenreGrid();

      // å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
      document.getElementById('selected-account-banner').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function clearSelectedAccount() {
      selectedAccount = null;
      document.getElementById('selected-account-banner').style.display = 'none';
      renderGenreGrid();
    }

    // --- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ ---
    function updateFilterSelect() {
      const data = getWatchData();
      const sel = document.getElementById('watch-filter-influencer');
      sel.innerHTML = '<option value="all">å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</option>' +
        data.influencers.map(i => `<option value="${i.handle}">@${i.handle}</option>`).join('');
    }

    // --- å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ ---
    function setInputMode(mode) {
      document.getElementById('input-mode-url').style.display = mode === 'url' ? 'block' : 'none';
      document.getElementById('input-mode-text').style.display = mode === 'text' ? 'block' : 'none';
      const urlBtn = document.getElementById('mode-url-btn');
      const txtBtn = document.getElementById('mode-text-btn');
      urlBtn.style.borderColor = mode === 'url' ? 'var(--accent-blue)' : 'var(--border)';
      urlBtn.style.color = mode === 'url' ? 'var(--accent-blue)' : 'var(--text-primary)';
      txtBtn.style.borderColor = mode === 'text' ? 'var(--accent-blue)' : 'var(--border)';
      txtBtn.style.color = mode === 'text' ? 'var(--accent-blue)' : 'var(--text-primary)';
    }

    // --- URLå…¥åŠ›ã§æŠ•ç¨¿è¿½åŠ  ---
    function addPostByUrl() {
      const urlInput = document.getElementById('watch-url-input');
      const url = urlInput.value.trim();

      const match = url.match(/(?:twitter\.com|x\.com)\/(\w+)\/status\/(\d+)/);
      if (!match) {
        alert('æœ‰åŠ¹ãªXæŠ•ç¨¿URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„\nä¾‹: https://x.com/user/status/12345');
        return;
      }

      const [_, urlHandle, tweetId] = match;
      // é¸æŠä¸­ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå„ªå…ˆã€ãªã‘ã‚Œã°URLã‹ã‚‰æŠ½å‡º
      let handle = selectedAccount || urlHandle;

      const data = getWatchData();

      // ãƒãƒ³ãƒ‰ãƒ«ãŒç›£è¦–ãƒªã‚¹ãƒˆã«ãªã„å ´åˆã¯è‡ªå‹•è¿½åŠ 
      if (!data.influencers.find(i => i.handle === handle)) {
        data.influencers.push({ handle, category: '', genre: 'other', added_at: new Date().toISOString() });
      }

      // é‡è¤‡ãƒã‚§ãƒƒã‚¯
      if (data.posts.find(p => p.tweet_id === tweetId)) {
        alert('ã“ã®æŠ•ç¨¿ã¯æ—¢ã«ç™»éŒ²æ¸ˆã¿ã§ã™'); return;
      }

      data.posts.unshift({
        id: `watch_${Date.now()}`,
        handle,
        tweet_id: tweetId,
        url,
        content: '',
        metrics: null,
        analysis: null,
        added_at: new Date().toISOString(),
        source: 'url'
      });

      saveWatchData(data);
      urlInput.value = '';
      renderGenreGrid();
      renderWatchPosts();
    }

    // --- ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã§æŠ•ç¨¿è¿½åŠ ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰ ---
    function addPostByText() {
      const content = document.getElementById('watch-text-content').value.trim();
      const likes = parseInt(document.getElementById('watch-text-likes').value) || 0;
      const rts = parseInt(document.getElementById('watch-text-rts').value) || 0;
      const impressions = parseInt(document.getElementById('watch-text-impressions').value) || 0;
      const url = document.getElementById('watch-text-url').value.trim();
      const handle = selectedAccount;

      if (!handle) { alert('ä¸Šã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒœã‚¿ãƒ³ã‚’å…ˆã«ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„'); return; }
      if (!content) { alert('æŠ•ç¨¿ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }

      const data = getWatchData();
      let tweetId = null;
      if (url) { const m = url.match(/status\/(\d+)/); if (m) tweetId = m[1]; }

      data.posts.unshift({
        id: `watch_${Date.now()}`,
        handle,
        tweet_id: tweetId,
        url: url || null,
        content,
        metrics: { likes, retweets: rts, impressions, collected_at: new Date().toISOString() },
        analysis: null,
        added_at: new Date().toISOString(),
        source: 'manual'
      });

      saveWatchData(data);
      document.getElementById('watch-text-content').value = '';
      document.getElementById('watch-text-likes').value = '';
      document.getElementById('watch-text-rts').value = '';
      document.getElementById('watch-text-impressions').value = '';
      document.getElementById('watch-text-url').value = '';
      renderGenreGrid();
      renderWatchPosts();
    }

    // --- æŠ•ç¨¿å‰Šé™¤ ---
    function removeWatchPost(postId) {
      const data = getWatchData();
      data.posts = data.posts.filter(p => p.id !== postId);
      saveWatchData(data);
      renderGenreGrid();
      renderWatchPosts();
    }

    // --- æŠ•ç¨¿ä¸€è¦§è¡¨ç¤º ---
    function renderWatchPosts() {
      const container = document.getElementById('watch-posts-list');
      const data = getWatchData();
      const filter = document.getElementById('watch-filter-influencer').value;

      let posts = data.posts;
      if (filter !== 'all') posts = posts.filter(p => p.handle === filter);

      if (posts.length === 0) {
        container.innerHTML = '<div class="card" style="text-align: center; color: var(--text-muted); padding: 40px;">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ Xã‚’è¦‹ã¦ â†’ URLã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„</div>';
        return;
      }

      container.innerHTML = posts.map(post => `
        <div class="saved-post-card">
          <div class="saved-post-header">
            <div style="display: flex; align-items: center; gap: 10px;">
              <a href="https://x.com/${post.handle}" target="_blank" class="saved-post-handle" style="text-decoration:none;">@${post.handle}</a>
              ${post.analysis ? '<span style="font-size:11px; padding:2px 6px; background:rgba(63,185,80,0.15); color:var(--accent-green); border-radius:4px;">åˆ†ææ¸ˆ</span>' : '<span style="font-size:11px; padding:2px 6px; background:rgba(210,153,34,0.15); color:var(--accent-orange); border-radius:4px;">æœªåˆ†æ</span>'}
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
              <span class="saved-post-date">${formatDate(post.added_at)}</span>
              ${post.url ? `<a href="${post.url}" target="_blank" style="color: var(--accent-blue); font-size: 12px;">ğŸ”— å…ƒæŠ•ç¨¿</a>` : ''}
              <button class="watch-btn watch-btn-danger" onclick="removeWatchPost('${post.id}')">âœ•</button>
            </div>
          </div>
          ${post.content ? `<div class="saved-post-content">${post.content.substring(0, 300)}${post.content.length > 300 ? '...' : ''}</div>` : '<div style="font-size:13px; color:var(--text-muted); margin: 4px 0;">ï¼ˆãƒ†ã‚­ã‚¹ãƒˆæœªå–å¾— â€” AIåˆ†ææ™‚ã«è‡ªå‹•å–å¾—ã•ã‚Œã¾ã™ï¼‰</div>'}
          ${post.metrics ? `
            <div class="saved-post-metrics">
              <span>ğŸ‘ï¸ ${formatNumber(post.metrics.impressions || 0)}</span>
              <span>â¤ï¸ ${post.metrics.likes || 0}</span>
              <span>ğŸ” ${post.metrics.retweets || 0}</span>
            </div>
          ` : ''}
          ${post.analysis && post.analysis.dialogue ? `
            <div style="margin-top: 10px; padding: 12px; background: var(--bg-card); border-radius: 8px; border-left: 3px solid var(--accent-blue);">
              <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px; font-weight: 600;">ğŸ¤– å°‚é–€å®¶åˆ†æ</div>
              ${post.analysis.dialogue.map(d => `
                <div style="margin-bottom: 8px; font-size: 13px;">
                  <span style="font-weight: 600; color: ${d.speaker === 'ãƒã‚ºåˆ†æå®˜' ? 'var(--accent-blue)' : d.speaker === 'å¿ƒç†å­¦è€…' ? 'var(--accent-green)' : 'var(--accent-orange)'};">${d.speaker}:</span>
                  <span style="color: var(--text-secondary);">${d.text}</span>
                </div>
              `).join('')}
              ${post.analysis.key_elements ? `
                <div style="margin-top: 8px; display: flex; gap: 4px; flex-wrap: wrap;">
                  ${post.analysis.key_elements.map(e => `<span class="tag">${e}</span>`).join('')}
                </div>
              ` : ''}
              ${post.analysis.takeaway ? `
                <div style="margin-top: 8px; padding: 8px; background: rgba(63,185,80,0.1); border-radius: 6px; font-size: 12px; color: var(--accent-green);">
                  ğŸ’¡ <strong>å­¦ã³:</strong> ${post.analysis.takeaway}
                </div>
              ` : ''}
            </div>
          ` : post.analysis ? `
            <div style="margin-top: 10px; padding: 10px; background: var(--bg-card); border-radius: 6px; font-size: 13px;">
              <div style="display: flex; gap: 16px; margin-bottom: 6px; flex-wrap: wrap;">
                <span>ğŸ£ <strong>${post.analysis.hook_type}</strong></span>
                <span>ğŸ“ ${post.analysis.structure}</span>
              </div>
              <div style="color: var(--text-secondary);">${post.analysis.why_it_works}</div>
            </div>
          ` : ''}
        </div>
      `).join('');
    }

    // --- AIåˆ†æï¼ˆç°¡æ˜“ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆ + ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§LLMæ·±å±¤åˆ†æï¼‰ ---
    async function analyzeAllPosts() {
      const data = getWatchData();
      const targets = data.posts.filter(p => !p.analysis && (p.content || p.url));

      if (targets.length === 0) {
        alert('åˆ†æå¯¾è±¡ã®æŠ•ç¨¿ãŒã‚ã‚Šã¾ã›ã‚“'); return;
      }

      document.getElementById('analyze-status').textContent = `${targets.length}ä»¶ã‚’åˆ†æä¸­...`;
      document.getElementById('analyze-all-btn').disabled = true;

      for (const post of targets) {
        if (post.content) {
          post.analysis = analyzePostLocally(post);
        } else {
          // ãƒ†ã‚­ã‚¹ãƒˆãªã—ï¼ˆURLã®ã¿ï¼‰â†’ ç°¡æ˜“ãƒãƒ¼ã‚¯
          post.analysis = {
            hook_type: 'æœªå–å¾—', structure: 'æœªå–å¾—', key_elements: [],
            why_it_works: 'ãƒ†ã‚­ã‚¹ãƒˆæœªå–å¾—ã®ãŸã‚LLMåˆ†æãŒå¿…è¦ã§ã™',
            dialogue: [
              { speaker: 'ãƒã‚ºåˆ†æå®˜', text: 'ã“ã®æŠ•ç¨¿ã¯URLã®ã¿ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆâ†’analyze-manualã§Grok/GPTãŒè©³ç´°åˆ†æã—ã¾ã™ã€‚' },
              { speaker: 'å¿ƒç†å­¦è€…', text: 'ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—ã§ãã‚Œã°ãƒ¦ãƒ¼ã‚¶ãƒ¼å¿ƒç†ã®å‹•ãæ–¹ã‚‚åˆ†æå¯èƒ½ã§ã™ã€‚' }
            ],
            takeaway: 'ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦LLMåˆ†æã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„',
            analyzed_at: new Date().toISOString(),
            method: 'placeholder'
          };
        }
      }

      saveWatchData(data);
      renderWatchPosts();
      renderGenreGrid();

      document.getElementById('analyze-status').textContent = `âœ… ${targets.length}ä»¶å®Œäº†`;
      document.getElementById('analyze-all-btn').disabled = false;
      setTimeout(() => { document.getElementById('analyze-status').textContent = ''; }, 3000);
    }

    // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æï¼ˆç°¡æ˜“ç‰ˆ â†’ å°‚é–€å®¶å¯¾è©±å½¢å¼ã§å‡ºåŠ›ï¼‰
    function analyzePostLocally(post) {
      const text = post.content;

      // ãƒ•ãƒƒã‚¯æ¤œå‡º
      let hookType = 'ä¸æ˜';
      const hookPatterns = [
        [/^æ­£ç›´/, 'æ­£ç›´ã€ç³»'], [/^æ–­è¨€/, 'æ–­è¨€ç³»'], [/^ã€|^â– |^â–¶/, 'è¦‹å‡ºã—ç³»'],
        [/^[ï¼Ÿ?]/, 'è³ªå•ç³»'], [/^\d/, 'æ•°å­—å§‹ã¾ã‚Š'], [/^å˜˜|^ãƒã‚¸|^è¡æ’ƒ/, 'é©šãç³»'],
        [/^æ·±å¤œ|^æœ|^æ˜¨æ—¥/, 'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç³»'], [/çŸ¥ã£ã¦ãŸ|çŸ¥ã‚‰ãªã„/, 'æƒ…å ±æ ¼å·®ç³»']
      ];
      for (const [pat, name] of hookPatterns) { if (text.match(pat)) { hookType = name; break; } }

      // æ§‹é€ 
      let structure = 'å˜æ–‡';
      if (text.includes('\n\n')) structure = 'æ®µè½åˆ†ã‘';
      if (text.match(/â‘ |â‘¡|1\.|2\.|ãƒ»/)) structure = 'ãƒªã‚¹ãƒˆå½¢å¼';
      if (text.length > 200 && text.includes('\n')) structure = 'ã‚¹ãƒ¬ãƒƒãƒ‰é¢¨';

      // è¦ç´ 
      const elements = [];
      if (text.match(/[0-9]+[%ï¼…å€ä¸‡ä»¶]/)) elements.push('æ•°å­—ã§è¨¼æ˜');
      if (text.match(/#\w+/)) elements.push('ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°');
      if (text.match(/[ï¼Ÿ?]$/m)) elements.push('è³ªå•ã§ç· ã‚');
      if (text.match(/è©¦ã—ã¦|ã‚„ã£ã¦|ä½¿ã£ã¦|ãƒã‚§ãƒƒã‚¯/)) elements.push('CTA');
      if (text.match(/æµ·å¤–|ã‚¢ãƒ¡ãƒªã‚«|ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼/)) elements.push('æµ·å¤–æƒ…å ±');
      if (text.match(/æ·±å¤œ|æœ|æ³£ã|é ­æŠ±ãˆ/)) elements.push('å…±æ„Ÿã‚¹ãƒˆãƒ¼ãƒªãƒ¼');

      // å°‚é–€å®¶å¯¾è©±å½¢å¼ã§åˆ†æã‚’ç”Ÿæˆ
      const likes = post.metrics?.likes || 0;
      const dialogue = [
        { speaker: 'ãƒã‚ºåˆ†æå®˜', text: `ãƒ•ãƒƒã‚¯ã¯ã€Œ${hookType}ã€ã€æ§‹é€ ã¯ã€Œ${structure}ã€ã€‚${elements.length > 0 ? elements.join('ãƒ»') + 'ã®è¦ç´ ãŒåŠ¹ã„ã¦ã„ã¾ã™ã€‚' : 'ç‰¹å¾´çš„ãªè¦ç´ ã¯å°‘ãªã‚ã§ã™ã€‚'}` },
        { speaker: 'å¿ƒç†å­¦è€…', text: likes >= 100
          ? 'ã“ã®ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã®é«˜ã•ã¯ã€èª­è€…ã®ã€Œè‡ªåˆ†ã”ã¨åŒ–ã€ãŒèµ·ãã¦ã„ã‚‹è¨¼æ‹ ã§ã™ã€‚èª²é¡Œã¸ã®å…±æ„Ÿâ†’è§£æ±ºç­–ã®æç¤ºã§å¿ƒç†çš„å ±é…¬ã‚’ä¸ãˆã¦ã„ã¾ã™ã€‚'
          : likes >= 30
            ? 'ãƒ‹ãƒƒãƒã ãŒæ·±ã„å…±æ„Ÿã‚’ç”Ÿã‚“ã§ã„ã¾ã™ã€‚ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ç—›ã¿ã«æ­£ç¢ºã«ãƒ’ãƒƒãƒˆã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚'
            : 'ã¾ã ãƒ‡ãƒ¼ã‚¿ä¸è¶³ã§ã™ãŒã€ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¶™ç¶šçš„ãªæ¤œè¨¼ãŒé‡è¦ã§ã™ã€‚' },
        { speaker: 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æˆ¦ç•¥å®¶', text: `@ai_risukirinã§å‚è€ƒã«ã™ã¹ãã¯ã€Œ${hookType}ã€ãƒ•ãƒƒã‚¯ã¨ã€Œ${structure}ã€ã®çµ„ã¿åˆã‚ã›ã€‚${text.length < 140 ? 'çŸ­æ–‡ã§å‡ç¸®ã•ã‚Œã¦ã„ã‚‹ã®ã‚‚ç‰¹å¾´ã€‚' : 'æƒ…å ±é‡ã‚’æŒãŸã›ã¤ã¤èª­ã¾ã›ã‚‹æ§‹æˆåŠ›ãŒéµã€‚'}` }
      ];

      const takeaway = `ã€Œ${hookType}ã€Ã—ã€Œ${structure}ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚${elements.length > 0 ? elements[0] + 'ãŒç‰¹ã«å‚è€ƒã«ãªã‚‹ã€‚' : 'LLMæ·±å±¤åˆ†æã§æ›´ã«è©³ç´°ãŒåˆ¤æ˜ã—ã¾ã™ã€‚'}`;

      return {
        hook_type: hookType,
        structure,
        key_elements: elements,
        why_it_works: dialogue[0].text,
        dialogue,
        takeaway,
        analyzed_at: new Date().toISOString(),
        method: 'local_pattern'
      };
    }

    // --- JSONã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ ---
    function exportWatchData() {
      const data = getWatchData();
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const u = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = u;
      a.download = `research_db_${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      URL.revokeObjectURL(u);
      data.last_exported = new Date().toISOString();
      saveWatchData(data);
    }

    // --- åˆæœŸãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰ ---
    async function initWatchData() {
      const existing = localStorage.getItem(WATCH_STORAGE_KEY);
      if (!existing || JSON.parse(existing).influencers.length === 0) {
        try {
          const res = await fetch('influencer_watch.json');
          if (res.ok) {
            const seed = await res.json();
            if (seed.influencers && seed.influencers.length > 0) {
              const current = existing ? JSON.parse(existing) : { posts: [] };
              seed.posts = [...(current.posts || []), ...(seed.posts || [])];
              saveWatchData(seed);
              console.log(`ğŸ”¬ ãƒªã‚µãƒ¼ãƒDB: ${seed.influencers.length}ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆæœŸãƒ­ãƒ¼ãƒ‰`);
            }
          }
        } catch (e) {
          console.log('åˆæœŸãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¹ã‚­ãƒƒãƒ—:', e.message);
        }
      }
      renderGenreGrid();
      updateFilterSelect();
      renderWatchPosts();
    }

    initWatchData();
  </script>
  </div><!-- end dashboard-wrapper -->

  <script>
    // ===== ç°¡æ˜“èªè¨¼ =====
    // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥ï¼ˆSHA-256ï¼‰ã‚’ä½¿ç”¨
    // å®Ÿéš›ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: devos2026
    const AUTH_HASH = '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918'; // 'admin'ã®ãƒãƒƒã‚·ãƒ¥ï¼ˆåˆæœŸå€¤ï¼‰
    
    async function hashPassword(password) {
      const encoder = new TextEncoder();
      const data = encoder.encode(password);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
    
    function checkAuth() {
      const authToken = sessionStorage.getItem('xme_auth');
      if (authToken === 'authenticated') {
        showDashboard();
        return true;
      }
      return false;
    }
    
    function showDashboard() {
      document.getElementById('auth-screen').style.display = 'none';
      document.getElementById('dashboard-wrapper').style.display = 'block';
    }
    
    document.getElementById('auth-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const password = document.getElementById('auth-password').value;
      const hash = await hashPassword(password);
      
      // è¨±å¯ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥
      const allowedHashes = [
        '8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918', // admin
        'a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3', // 123
        '5e884898da28047d9171f37b05019f0d70f0e5e22e6e4c89d4f54ae4c0b60e6e', // password
        // ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ console.log(await hashPassword('your-password')) ã§å–å¾—
      ];
      
      if (allowedHashes.includes(hash)) {
        sessionStorage.setItem('xme_auth', 'authenticated');
        showDashboard();
      } else {
        document.getElementById('auth-error').classList.add('show');
        document.getElementById('auth-password').value = '';
        setTimeout(() => {
          document.getElementById('auth-error').classList.remove('show');
        }, 3000);
      }
    });
    
    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰å®Ÿè¡Œå¯èƒ½ï¼‰
    window.logout = function() {
      sessionStorage.removeItem('xme_auth');
      location.reload();
    };
    
    // åˆæœŸåŒ–æ™‚ã«èªè¨¼ãƒã‚§ãƒƒã‚¯
    if (!checkAuth()) {
      document.getElementById('auth-password').focus();
    }
  </script>
</body>
</html>
